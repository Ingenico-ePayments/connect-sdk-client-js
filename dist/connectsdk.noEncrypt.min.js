!function(e){var t={},n={};t.define=function(e,t,i){if(t&&t.length)for(var o=0;o<t.length;o++)t[o]=n[t[o]];n[e]=i.apply(this,t||[])},e.connectsdk=t,"undefined"!=typeof exports&&(exports.connectsdk=t),t.define("connectsdk.core",[],function(){return t}),"undefined"==typeof define&&(e.define=t.define)}("undefined"==typeof window?this:window),define("connectsdk.core",[],function(){var e={};return("undefined"==typeof window?this:window).connectsdk=e,"undefined"!=typeof exports&&(exports.connectsdk=e),e}),define("connectsdk.promise",["connectsdk.core"],function(e){return function(e){function t(e){var t=this;this.pending=[],this.resolve=function(e){t.complete("resolve",e)},this.reject=function(e){t.complete("reject",e)},e&&(this.isSingleton=!0)}t.prototype={then:function(e,t){return this.pending.push({resolve:e,reject:t}),this},complete:function(e,t){for(;this.pending[0];)this.pending.shift()[e](t)}},e.Promise=t}(connectsdk),connectsdk.Promise}),define("connectsdk.net",["connectsdk.core"],function(e){var t={},n="".trim?function(e){return e.trim()}:function(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")};function i(n,i){var o,s,r=function(){if(!("undefined"==typeof XMLHttpRequest||"file:"===window.location.protocol&&window.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}return!1}(),c={};function a(){try{!function(){var e={Accept:"text/javascript, application/json, text/html, application/xml, text/xml, */*","Content-Type":"application/json"};for(var t in e)i.headers.hasOwnProperty(t)||(i.headers[t]=e[t]);for(var t in i.headers)r.setRequestHeader(t,i.headers[t])}(),r.send(i.postBody)}catch(e){i.error&&i.error()}}return e.Promise&&(o=new e.Promise),void 0===i&&(i={}),i.method=i.method?i.method.toLowerCase():"get",i.asynchronous=i.asynchronous||!0,i.postBody=i.postBody||"",r.onreadystatechange=function(e){if(4==r.readyState){var n=r.mimeType||r.getResponseHeader("content-type")||"";if(c.status=r.status,c.responseText=r.responseText,/json/.test(n)?c.responseJSON=t.parseJSON(r.responseText):/xml/.test(n)&&(c.responseXML=t.parseXML(r.responseText)),c.success=function(e){return e.status>=200&&e.status<300||304==e.status||0==e.status&&e.responseText}(r),i.callback)return i.callback(c,r);c.success?(i.success&&i.success(c,r),o&&o.resolve(c,r)):(i.error&&i.error(c,r),o&&o.reject(c,r))}},r.open(i.method,n,i.asynchronous),i.headers=i.headers||{},i.contentType&&(i.headers["Content-Type"]=i.contentType),"string"!=typeof i.postBody&&(i.postBody=t.serialize(i.postBody)),s={set:function(e,t){return i.headers[e]=t,s},send:function(e,n){return i.postBody=t.serialize(e),i.callback=n,a(),s},end:function(e){return i.callback=e,a(),s},data:function(e){return i.postBody=t.serialize(e),s},then:function(){return s.end(),o&&o.then.apply(o,arguments),s}}}function o(e,t,n){var i=this;this.url=e,this.methodName="__connectsdk_jsonp_"+parseInt((new Date).getTime()),this.success=t,this.failure=n,window[this.methodName]=function(e){i.success(e),i.teardown()}}return t.serialize=function(e){if(e){if("string"==typeof e)return e;var t=[];for(var n in e)t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")}},t.parseJSON=function(e){return"string"==typeof e&&e?(e=n(e),window.JSON.parse(e)):null},window.DOMParser?t.parseXML=function(e){return(new DOMParser).parseFromString(e,"text/xml")}:t.parseXML=function(e){var t=new ActiveXObject("Microsoft.XMLDOM");return t.async="false",t.loadXML(e),t},o.prototype.run=function(){this.scriptTag=document.createElement("script"),this.scriptTag.id=this.methodName,this.scriptTag.src=this.url.replace("{callback}",this.methodName);var e=this;this.scriptTag.onerror=function(){e.failure()},document.body.appendChild(this.scriptTag)},o.prototype.teardown=function(){window[this.methodName]=null;try{delete window[this.methodName]}catch(e){}this.scriptTag&&document.body.removeChild(this.scriptTag)},t.get=function(e,t){return void 0===t&&(t={}),t.method="get",i(e,t)},t.post=function(e,t){return void 0===t&&(t={}),t.method="post",i(e,t)},t.jsonp=function(e,t){void 0===t&&(t={}),new o(e,t.success,t.failure).run()},e.get=t.get,e.post=t.post,e.jsonp=t.jsonp,t.ajax=i,e.net=t,t}),define("connectsdk.Util",["connectsdk.core"],function(e){var t=function(){var e;return{getInstance:function(){return e||(e={applePayPaymentProductId:302,googlePayPaymentProductId:320,bancontactPaymentProductId:3012,getMetadata:function(){return{screenSize:window.innerWidth+"x"+window.innerHeight,platformIdentifier:window.navigator.userAgent,sdkIdentifier:(document.GC&&document.GC.rppEnabledPage?"rpp-":"")+"JavaScriptClientSDK/v3.14.0",sdkCreator:"Ingenico"}},collectDeviceInformation:function(){return{timezoneOffsetUtcMinutes:(new Date).getTimezoneOffset(),locale:navigator.language,browserData:{javaScriptEnabled:!0,javaEnabled:navigator.javaEnabled(),colorDepth:screen.colorDepth,screenHeight:screen.height,screenWidth:screen.width,innerHeight:window.innerHeight,innerWidth:window.innerWidth}}},base64Encode:function(e){if("object"==typeof e)try{e=JSON.stringify(e)}catch(e){throw"data must be either a String or a JSON object"}var t,n,i,o,s,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c=0,a=0,u="",d=[];if(!e)return e;do{t=(s=e.charCodeAt(c++)<<16|e.charCodeAt(c++)<<8|e.charCodeAt(c++))>>18&63,n=s>>12&63,i=s>>6&63,o=63&s,d[a++]=r.charAt(t)+r.charAt(n)+r.charAt(i)+r.charAt(o)}while(c<e.length);u=d.join("");var l=e.length%3;return(l?u.slice(0,l-3):u)+"===".slice(l||3)},filterOutProductsThatAreNotSupportedInThisBrowser:function(e){for(var t=e.paymentProducts.length-1;t>=0;t--){var n=e.paymentProducts[t];n&&this.paymentProductsThatAreNotSupportedInThisBrowser.indexOf(n.id)>-1&&e.paymentProducts.splice(t,1)}},paymentProductsThatAreNotSupportedInThisBrowser:[302]}),e}}}();return e.Util=t,t}),define("connectsdk.GooglePay",["connectsdk.core","connectsdk.promise","connectsdk.Util"],function(e,t,n){var i=n.getInstance(),o=null,s=null,r=null,c=null,a=null,u=function(){return{type:"CARD",parameters:{allowedAuthMethods:["PAN_ONLY","CRYPTOGRAM_3DS"],allowedCardNetworks:c}}},d=function(){return{apiVersion:2,apiVersionMinor:0,allowedPaymentMethods:[Object.assign({},u(),{tokenizationSpecification:{type:"PAYMENT_GATEWAY",parameters:{gateway:r,gatewayMerchantId:o.googlePay.gatewayMerchantId}}})],transactionInfo:{totalPriceStatus:"NOT_CURRENTLY_KNOWN",currencyCode:s.currency},merchantInfo:{merchantName:o.googlePay.merchantName}}};function l(){if(null===a){var e="TEST";"PROD"===s.environment&&(e="PROD"),window.google?a=new google.payments.api.PaymentsClient({environment:e}):console.error("The Google Pay API script was not loaded https://developers.google.com/pay/api/web/guides/tutorial#js-load")}return a}var p=function(e){e,this.isGooglePayAvailable=function(e,n,a){s=e,o=n,a&&a.networks?(r=a.gateway,c=a.networks):(r="ingenicoglobalcollect",c=a);var p=new t;return setTimeout(function(){if(c&&c.length>0){var e=l();e?e.isReadyToPay({apiVersion:2,apiVersionMinor:0,allowedPaymentMethods:[u()]}).then(function(e){var t,n;p.resolve(e),t=d(),n=l(),o.googlePay.gatewayMerchantId&&o.googlePay.merchantName?n.prefetchPaymentData(t):console.warn("Prefetching payment data was not triggered because of missing information. gatewayMerchantId: "+o.googlePay.gatewayMerchantId+", merchantName: "+o.googlePay.merchantName)}).catch(function(){i.paymentProductsThatAreNotSupportedInThisBrowser.push(i.googlePayPaymentProductId),p.reject("failed to run isReadyToPay() with Google Pay API")}):(i.paymentProductsThatAreNotSupportedInThisBrowser.push(i.googlePayPaymentProductId),p.reject("The Google Pay API script was not loaded https://developers.google.com/pay/api/web/guides/tutorial#js-load"))}else i.paymentProductsThatAreNotSupportedInThisBrowser.push(i.googlePayPaymentProductId),p.reject("There are no product networks available")},0),p},this.isMerchantIdProvided=function(e){return e.googlePay.merchantId?e.googlePay.merchantId:(i.paymentProductsThatAreNotSupportedInThisBrowser.push(i.googlePayPaymentProductId),!1)}};return e.GooglePay=p,p}),define("connectsdk.PublicKeyResponse",["connectsdk.core"],function(e){var t=function(e){this.json=e,this.keyId=e.keyId,this.publicKey=e.publicKey};return e.PublicKeyResponse=t,t}),define("connectsdk.C2SCommunicatorConfiguration",["connectsdk.core"],function(e){var t=function(e,t){if(this.endpoints={PROD:{EU:{API:"https://ams1.api-ingenico.com/client/v1",ASSETS:"https://assets.pay1.secured-by-ingenico.com"},US:{API:"https://us.api-ingenico.com/client/v1",ASSETS:"https://assets.pay2.secured-by-ingenico.com"},AMS:{API:"https://ams2.api-ingenico.com/client/v1",ASSETS:"https://assets.pay3.secured-by-ingenico.com"},PAR:{API:"https://par.api-ingenico.com/client/v1",ASSETS:"https://assets.pay4.secured-by-ingenico.com"}},PREPROD:{EU:{API:"https://ams1.preprod.api-ingenico.com/client/v1",ASSETS:"https://assets.pay1.preprod.secured-by-ingenico.com"},US:{API:"https://us.preprod.api-ingenico.com/client/v1",ASSETS:"https://assets.pay2.preprod.secured-by-ingenico.com"},AMS:{API:"https://ams2.preprod.api-ingenico.com/client/v1",ASSETS:"https://assets.pay3.preprod.secured-by-ingenico.com"},PAR:{API:"https://par-preprod.api-ingenico.com/client/v1",ASSETS:"https://assets.pay4.preprod.secured-by-ingenico.com"}},SANDBOX:{EU:{API:"https://ams1.sandbox.api-ingenico.com/client/v1",ASSETS:"https://assets.pay1.sandbox.secured-by-ingenico.com"},US:{API:"https://us.sandbox.api-ingenico.com/client/v1",ASSETS:"https://assets.pay2.sandbox.secured-by-ingenico.com"},AMS:{API:"https://ams2.sandbox.api-ingenico.com/client/v1",ASSETS:"https://assets.pay3.sandbox.secured-by-ingenico.com"},PAR:{API:"https://par.sandbox.api-ingenico.com/client/v1",ASSETS:"https://assets.pay4.sandbox.secured-by-ingenico.com"}},INTEGRATION:{EU:{API:"https://int-test-api.gcsip.nl:4443/client/v1",ASSETS:"https://assets.int-test-rpp.gcsip.nl:4443"},US:{API:"https://int-test-api.gcsip.nl:4443/client/v1",ASSETS:"https://assets.int-test-rpp.gcsip.nl:4443"},AMS:{API:"https://int-test-api.gcsip.nl:4443/client/v1",ASSETS:"https://assets.int-test-rpp.gcsip.nl:4443"},PAR:{API:"https://int-test-api.gcsip.nl:4443/client/v1",ASSETS:"https://assets.int-test-rpp.gcsip.nl:4443"}},DEV_NAMI:{EU:{API:"https://nami-test-api.gcsip.nl:4443/client/v1",ASSETS:"https://assets.nami-test-rpp.gcsip.nl:4443"},US:{API:"https://nami-test-api.gcsip.nl:4443/client/v1",ASSETS:"https://assets.nami-test-rpp.gcsip.nl:4443"},AMS:{API:"https://nami-test-api.gcsip.nl:4443/client/v1",ASSETS:"https://assets.nami-test-rpp.gcsip.nl:4443"},PAR:{API:"https://nami-test-api.gcsip.nl:4443/client/v1",ASSETS:"https://assets.nami-test-rpp.gcsip.nl:4443"}},DEV_ISC:{EU:{API:"//api.gc-dev.isaac.local/client/v1",ASSETS:"//rpp.gc-dev.isaac.local"},US:{API:"//api.gc-ci-dev.isaac.local/client/v1",ASSETS:"//rpp.gc-ci-dev.isaac.local"},AMS:{API:"//api.gc-dev.isaac.local/client/v1",ASSETS:"//rpp.gc-dev.isaac.local"},PAR:{API:"//api.gc-dev.isaac.local/client/v1",ASSETS:"//rpp.gc-dev.isaac.local"}}},e.clientSessionId){if(e.clientSessionID)throw new Error("You cannot use both the clientSessionId and the clientSessionID at the same time, please use the clientSessionId only.")}else e.clientSessionId=e.clientSessionID;if(e.assetUrl){if(e.assetsBaseUrl)throw new Error("You cannot use both the assetUrl and the assetsBaseUrl at the same time, please use the assetUrl only.")}else e.assetUrl=e.assetsBaseUrl;if(e.clientApiUrl){if(e.apiBaseUrl)throw new Error("You cannot use both the clientApiUrl and the apiBaseUrl at the same time, please use the clientApiUrl only.")}else e.clientApiUrl=e.apiBaseUrl;if(this.clientSessionId=e.clientSessionId,this.customerId=e.customerId,e.region&&!e.clientApiUrl)console.warn("Using regions is deprecated, switch to clientApiUrl"),this.clientApiUrl=this.endpoints[e.environment][e.region].API,this.assetUrl=this.endpoints[e.environment][e.region].ASSETS;else{if(this.clientApiUrl=e.clientApiUrl,this.assetUrl=e.assetUrl,!this.clientApiUrl)throw new Error("This version of the connectSDK requires an clientApiUrl, which you did not provide.");if(!this.assetUrl)throw new Error("This version of the connectSDK requires an assetUrl, which you did not provide.");if(-1===this.clientApiUrl.indexOf("//"))throw new Error("A valid URL is required for the clientApiUrl, you provided '"+this.clientApiUrl+"'");var n=this.clientApiUrl.split("/");if(""!==n[0]&&0!==n[0].indexOf("http"))throw new Error("A valid URL is required for the clientApiUrl, you provided '"+this.clientApiUrl+"'");var i=n.splice(3).join("/");if(i){if("client"===i)this.clientApiUrl+="/"+t.split("/")[1];else if(0!==i.indexOf(t)||i.length!==t.length)throw new Error("This version of the connectSDK is only compatible with "+t+", you supplied: '"+i+"'")}else this.clientApiUrl+="/"+t}};return e.C2SCommunicatorConfiguration=t,t}),define("connectsdk.IinDetailsResponse",["connectsdk.core","connectsdk.promise"],function(e,t){var n=function(){this.status="",this.countryCode="",this.paymentProductId="",this.isAllowedInContext="",this.coBrands=[]};return e.IinDetailsResponse=n,n}),define("connectsdk.C2SCommunicator",["connectsdk.core","connectsdk.promise","connectsdk.net","connectsdk.Util","connectsdk.PublicKeyResponse","connectsdk.IinDetailsResponse","connectsdk.GooglePay"],function(e,t,n,i,o,s,r){var c=function(e,c){var a=e,u=i.getInstance(),d={},l=c,p=new r(this),h={expirydate:"tel",string:"text",numericstring:"tel",integer:"number",expirationDate:"tel"},f=function(e){return e&&g(e,"/")?e:e+"/"},y=function(e,t){return e=f(e),m(t,e)?t:e+t},m=function(e,t){return 0===e.indexOf(t)},g=function(e,t){return-1!==e.indexOf(t,e.length-t.length)},P=function(e,t){for(var n=0,i=e.fields.length;n<i;n++){var o=e.fields[n];for(validatorKey in o.type=o.displayHints&&o.displayHints.obfuscate?"password":h[o.type],o.dataRestrictions.validators)o.validators=o.validators||[],o.validators.push(validatorKey);o.displayHints&&o.displayHints.formElement&&"list"===o.displayHints.formElement.type&&(o.displayHints.formElement.list=!0),o.displayHints&&o.displayHints.tooltip&&o.displayHints.tooltip.image&&(o.displayHints.tooltip.image=y(t,o.displayHints.tooltip.image))}return e.fields.sort(function(e,t){return e.displayHints.displayOrder<t.displayHints.displayOrder?-1:1}),e.displayHints.logo=y(t,e.displayHints.logo),e},v=function(e,t,n){for(var i=0,o=e["paymentProduct"+n].length;i<o;i++){var s=e["paymentProduct"+n][i];s.displayHints.logo=y(t,s.displayHints.logo)}return e["paymentProduct"+n].sort(function(e,t){return e.displayHints.displayOrder<t.displayHints.displayOrder?-1:1}),e},k=u.getMetadata();this.getBasicPaymentProducts=function(e,i){var o=e.locale?e.locale+"_":"";i=i||{};var s=new t,r=(new Date).getTime(),c="getPaymentProducts-"+e.totalAmount+"_"+e.countryCode+"_"+o+e.isRecurring+"_"+e.currency+"_"+JSON.stringify(i);if(d[c])setTimeout(function(){s.resolve(d[c])},0);else{var l=e.locale?"&locale="+e.locale:"";n.get(f(a.clientApiUrl)+a.customerId+"/products?countryCode="+e.countryCode+"&isRecurring="+e.isRecurring+"&amount="+e.totalAmount+"&currencyCode="+e.currency+"&hide=fields"+l+"&cacheBust="+r).set("X-GCS-ClientMetaInfo",u.base64Encode(k)).set("Authorization","GCS v1Client:"+a.clientSessionId).end(function(t){if(t.success){var n=v(t.responseJSON,a.assetUrl,"s");if(function(e,t){for(var n=e.length-1;n>=0;n--){var i=e[n];if(i&&i.id===t)return!0}return!1}(n.paymentProducts,u.googlePayPaymentProductId))if(p.isMerchantIdProvided(i)){var o=function(e,t){for(var n=e.length-1;n>=0;n--){var i=e[n];if(i&&i.id===t)return i.paymentProduct320SpecificData}return!1}(n.paymentProducts,u.googlePayPaymentProductId);p.isGooglePayAvailable(e,i,o).then(function(e){u.filterOutProductsThatAreNotSupportedInThisBrowser(n),0===n.paymentProducts.length&&s.reject("No payment products available"),d[c]=n,s.resolve(n)},function(){u.filterOutProductsThatAreNotSupportedInThisBrowser(n),0===n.paymentProducts.length&&s.reject("No payment products available"),d[c]=n,s.resolve(n)})}else u.filterOutProductsThatAreNotSupportedInThisBrowser(n),console.warn("You have not provided a merchantId for Google Pay, you can set this in the paymentProductSpecificInputs object"),s.resolve(n);else u.filterOutProductsThatAreNotSupportedInThisBrowser(n),0===n.paymentProducts.length&&s.reject("No payment products available"),d[c]=n,s.resolve(n)}else s.reject("failed to retrieve Basic Payment Products",t)})}return s},this.getBasicPaymentProductGroups=function(e){var i=e.locale?e.locale+"_":"",o=new t,s=(new Date).getTime(),r="getPaymentProductGroups-"+e.totalAmount+"_"+e.countryCode+"_"+i+e.isRecurring+"_"+e.currency;if(d[r])setTimeout(function(){o.resolve(d[r])},0);else{var c=e.locale?"&locale="+e.locale:"";n.get(f(a.clientApiUrl)+a.customerId+"/productgroups?countryCode="+e.countryCode+"&isRecurring="+e.isRecurring+"&amount="+e.totalAmount+"&currencyCode="+e.currency+"&hide=fields"+c+"&cacheBust="+s).set("X-GCS-ClientMetaInfo",u.base64Encode(k)).set("Authorization","GCS v1Client:"+a.clientSessionId).end(function(e){if(e.success){var t=v(e.responseJSON,a.assetUrl,"Groups");d[r]=t,o.resolve(t)}else o.reject()})}return o},this.getPaymentProduct=function(i,o,s){s=s||{};var r=o.locale?o.locale+"_":"",c=new t,h=(new Date).getTime(),y="getPaymentProduct-"+i+"_"+o.totalAmount+"_"+o.countryCode+"_"+r+o.isRecurring+"_"+o.currency+"_"+JSON.stringify(s);if(u.paymentProductsThatAreNotSupportedInThisBrowser.indexOf(i)>-1)setTimeout(function(){c.reject({errorId:"48b78d2d-1b35-4f8b-92cb-57cc2638e901",errors:[{code:"1007",propertyName:"productId",message:"UNKNOWN_PRODUCT_ID",httpStatusCode:404}]})},0);else if(l&&l.id===i)d[y]||(d[y]=P(l,a.assetUrl)),setTimeout(function(){c.resolve(d[y])},0);else if(d[y])setTimeout(function(){c.resolve(d[y])},0);else{var m=o.locale?"&locale="+o.locale:"",g=f(a.clientApiUrl)+a.customerId+"/products/"+i+"?countryCode="+o.countryCode+"&isRecurring="+o.isRecurring+"&amount="+o.totalAmount+"&currencyCode="+o.currency+m;i===u.bancontactPaymentProductId&&s&&s.bancontact&&s.bancontact.forceBasicFlow&&(g+="&forceBasicFlow="+s.bancontact.forceBasicFlow),g+="&cacheBust="+h,n.get(g).set("X-GCS-ClientMetaInfo",u.base64Encode(k)).set("Authorization","GCS v1Client:"+a.clientSessionId).end(function(t){if(t.success){var n=P(t.responseJSON,e.assetUrl);if(i===u.googlePayPaymentProductId)if(p.isMerchantIdProvided(s)){var r=n.paymentProduct320SpecificData.networks;p.isGooglePayAvailable(o,s,r).then(function(e){e?(d[y]=n,c.resolve(n)):(d[y]=n,c.reject(n))},function(){d[y]=n,c.reject(n)})}else d[y]=n,c.reject(n);else d[y]=n,c.resolve(n)}else c.reject("failed to retrieve Payment Product",t)})}return c},this.getPaymentProductGroup=function(i,o){var s=o.locale?o.locale+"_":"",r=new t,c=(new Date).getTime(),p="getPaymentProductGroup-"+i+"_"+o.totalAmount+"_"+o.countryCode+"_"+s+o.isRecurring+"_"+o.currency;if(l&&l.id===i)d[p]?setTimeout(function(){r.resolve(d[p])},0):(d[p]=P(l,a.assetUrl),setTimeout(function(){r.resolve(d[p])},0));else if(d[p])setTimeout(function(){r.resolve(d[p])},0);else{var h=o.locale?"&locale="+o.locale:"";n.get(f(a.clientApiUrl)+a.customerId+"/productgroups/"+i+"?countryCode="+o.countryCode+"&isRecurring="+o.isRecurring+"&amount="+o.totalAmount+"&currencyCode="+o.currency+h+"&cacheBust="+c).set("X-GCS-ClientMetaInfo",u.base64Encode(k)).set("Authorization","GCS v1Client:"+a.clientSessionId).end(function(t){if(t.success){var n=P(t.responseJSON,e.assetUrl);d[p]=n,r.resolve(n)}else r.reject()})}return r},this.getPaymentProductIdByCreditCardNumber=function(e,i){var o=new t,r=new s,c="getPaymentProductIdByCreditCardNumber-"+e,l=this;if(this.context=i,d[c])setTimeout(function(){o.resolve(d[c])},0);else{!function(e){return e.length>=6}(e)?(r.status="NOT_ENOUGH_DIGITS",setTimeout(function(){o.resolve(r)},0)):n.post(f(a.clientApiUrl)+a.customerId+"/services/getIINdetails").data(JSON.stringify(this.convertContextToIinDetailsContext(e,this.context))).set("X-GCS-ClientMetaInfo",u.base64Encode(k)).set("Authorization","GCS v1Client:"+a.clientSessionId).end(function(e){e.success?(r.json=e.responseJSON,r.countryCode=e.responseJSON.countryCode,r.paymentProductId=e.responseJSON.paymentProductId,r.isAllowedInContext=e.responseJSON.isAllowedInContext,r.coBrands=e.responseJSON.coBrands,e.responseJSON.hasOwnProperty("isAllowedInContext")?(r.status="SUPPORTED",!1===r.isAllowedInContext&&(r.status="EXISTING_BUT_NOT_ALLOWED"),d[c]=r,o.resolve(r)):l.getPaymentProduct(r.paymentProductId,l.context).then(function(e){r.status=e?"SUPPORTED":"UNSUPPORTED",d[c]=r,o.resolve(r)},function(){r.status="UNKNOWN",o.reject(r)})):(r.status="UNKNOWN",o.reject(r))})}return o},this.convertContextToIinDetailsContext=function(e,t){var n={bin:e,paymentContext:{countryCode:t.countryCode,isRecurring:t.isRecurring,amountOfMoney:{amount:t.totalAmount,currencyCode:t.currency}}};return void 0!==t.accountOnFileId&&(n.accountOnFileId=t.accountOnFileId),n},this.getPublicKey=function(){var e=new t;return d.publicKey?setTimeout(function(){e.resolve(d.publicKey)},0):n.get(f(a.clientApiUrl)+a.customerId+"/crypto/publickey").set("X-GCS-ClientMetaInfo",u.base64Encode(k)).set("Authorization","GCS v1Client:"+a.clientSessionId).end(function(t){if(t.success){var n=new o(t.responseJSON);d.publicKey=n,e.resolve(n)}else e.reject("unable to get public key")}),e},this.getPaymentProductNetworks=function(e,i){var o=new t,s="paymentProductNetworks-"+e+"_"+i.countryCode+"_"+i.currency+"_"+i.totalAmount+"_"+i.isRecurring;return d[s]?setTimeout(function(){o.resolve(d[s])},0):n.get(f(a.clientApiUrl)+a.customerId+"/products/"+e+"/networks?countryCode="+i.countryCode+"&currencyCode="+i.currency+"&amount="+i.totalAmount+"&isRecurring="+i.isRecurring).set("X-GCS-ClientMetaInfo",u.base64Encode(k)).set("Authorization","GCS v1Client:"+a.clientSessionId).end(function(e){e.success?(d[s]=e.responseJSON,o.resolve(e.responseJSON)):o.reject()}),o},this.getPaymentProductDirectory=function(e,i,o){var s=new t,r="getPaymentProductDirectory-"+e+"_"+i+"_"+o;return d[r]?setTimeout(function(){s.resolve(d[r])},0):n.get(f(a.clientApiUrl)+a.customerId+"/products/"+e+"/directory?countryCode="+o+"&currencyCode="+i).set("X-GCS-ClientMetaInfo",u.base64Encode(k)).set("Authorization","GCS v1Client:"+a.clientSessionId).end(function(e){e.success?(d[r]=e.responseJSON,s.resolve(e.responseJSON)):s.reject("unable to retrieve payment product directory")}),s},this.convertAmount=function(e,i,o){var s=new t,r="convertAmount-"+e+"_"+i+"_"+o;return d[r]?setTimeout(function(){s.resolve(d[r])},0):n.get(f(a.clientApiUrl)+a.customerId+"/services/convert/amount?source="+i+"&target="+o+"&amount="+e).set("X-GCS-ClientMetaInfo",u.base64Encode(k)).set("Authorization","GCS v1Client:"+a.clientSessionId).end(function(e){e.success?(d[r]=e.responseJSON,s.resolve(e.responseJSON)):s.reject("unable to convert amount")}),s},this.getThirdPartyPaymentStatus=function(e){var i=new t;return n.get(f(a.clientApiUrl)+a.customerId+"/payments/"+e+"/thirdpartystatus").set("X-GCS-ClientMetaInfo",u.base64Encode(k)).set("Authorization","GCS v1Client:"+a.clientSessionId).end(function(e){e.success?i.resolve(e.responseJSON):i.reject("unable to retrieve third party status")}),i},this.getCustomerDetails=function(e,i){var o=new t,s="getCustomerDetails_"+i.countryCode;return s=S(s,i.values),d[s]?setTimeout(function(){o.resolve(d[s])},0):n.post(f(a.clientApiUrl)+a.customerId+"/products/"+e+"/customerDetails").data(JSON.stringify(i)).set("X-GCS-ClientMetaInfo",u.base64Encode(k)).set("Authorization","GCS v1Client:"+a.clientSessionId).end(function(e){e.success?(d[s]=e.responseJSON,o.resolve(e.responseJSON)):o.reject(e.responseJSON)}),o};var S=function(e,t){var n=e;for(var i in t)t.hasOwnProperty(i)&&(n+="_"+t[i].key+"_"+t[i].value);return n};this.transformPaymentProductJSON=function(e){return P(e,a.assetUrl)}};return e.C2SCommunicator=c,c}),define("connectsdk.LabelTemplateElement",["connectsdk.core"],function(e){var t=function(e){this.json=e,this.attributeKey=e.attributeKey,this.mask=e.mask,this.wildcardMask=e.mask?e.mask.replace(/9/g,"*"):""};return e.LabelTemplateElement=t,t}),define("connectsdk.Attribute",["connectsdk.core"],function(e){var t=function(e){this.json=e,this.key=e.key,this.value=e.value,this.status=e.status,this.mustWriteReason=e.mustWriteReason};return e.Attribute=t,t}),define("connectsdk.AccountOnFileDisplayHints",["connectsdk.core","connectsdk.LabelTemplateElement"],function(e,t){var n=function(e){this.json=e,this.labelTemplate=[],this.labelTemplateElementByAttributeKey={},function(e,n,i){if(e.labelTemplate)for(var o=0,s=e.labelTemplate.length;o<s;o++){var r=new t(e.labelTemplate[o]);n.push(r),i[r.attributeKey]=r}}(e,this.labelTemplate,this.labelTemplateElementByAttributeKey)};return e.AccountOnFileDisplayHints=n,n}),define("connectsdk.AccountOnFile",["connectsdk.core","connectsdk.AccountOnFileDisplayHints","connectsdk.Attribute"],function(e,t,n){var i=function(i){this.json=i,this.attributes=[],this.attributeByKey={},this.displayHints=new t(i.displayHints),this.id=i.id,this.paymentProductId=i.paymentProductId,this.getMaskedValueByAttributeKey=function(t){var n,i=this.attributeByKey[t].value;try{n=this.displayHints.labelTemplateElementByAttributeKey[t].wildcardMask}catch(e){}if(void 0!==i&&void 0!==n)return(new e.MaskingUtil).applyMask(n,i)},function(e,t,i){if(e.attributes)for(var o=0,s=e.attributes.length;o<s;o++){var r=new n(e.attributes[o]);t.push(r),i[r.key]=r}}(i,this.attributes,this.attributeByKey)};return e.AccountOnFile=i,i}),define("connectsdk.PaymentProduct302SpecificData",["connectsdk.core"],function(e){var t=function(e){this.json=e,this.networks=e.networks};return e.PaymentProduct302SpecificData=t,t}),define("connectsdk.PaymentProduct320SpecificData",["connectsdk.core"],function(e){var t=function(e){this.json=e,this.gateway=e.gateway,this.networks=e.networks};return e.PaymentProduct320SpecificData=t,t}),define("connectsdk.PaymentProduct863SpecificData",["connectsdk.core"],function(e){var t=function(e){this.json=e,this.integrationTypes=e.integrationTypes};return e.PaymentProduct863SpecificData=t,t}),define("connectsdk.PaymentProductDisplayHints",["connectsdk.core"],function(e){var t=function(e){this.json=e,this.displayOrder=e.displayOrder,this.label=e.label,this.logo=e.logo};return e.PaymentProductDisplayHints=t,t}),define("connectsdk.BasicPaymentProduct",["connectsdk.core","connectsdk.AccountOnFile","connectsdk.PaymentProductDisplayHints","connectsdk.PaymentProduct302SpecificData","connectsdk.PaymentProduct320SpecificData","connectsdk.PaymentProduct863SpecificData"],function(e,t,n,i,o,s){var r=function(e){this.json=e,this.json.type="product",this.accountsOnFile=[],this.accountOnFileById={},this.allowsRecurring=e.allowsRecurring,this.allowsTokenization=e.allowsTokenization,this.autoTokenized=e.autoTokenized,this.displayHints=new n(e.displayHints),this.id=e.id,this.maxAmount=e.maxAmount,this.minAmount=e.minAmount,this.paymentMethod=e.paymentMethod,this.mobileIntegrationLevel=e.mobileIntegrationLevel,this.usesRedirectionTo3rdParty=e.usesRedirectionTo3rdParty,this.paymentProductGroup=e.paymentProductGroup,function(e,n,r,c){if(e.accountsOnFile)for(var a=0,u=e.accountsOnFile.length;a<u;a++){var d=new t(e.accountsOnFile[a]);r.push(d),c[d.id]=d}e.paymentProduct302SpecificData&&(n.paymentProduct302SpecificData=new i(e.paymentProduct302SpecificData)),e.paymentProduct320SpecificData&&(n.paymentProduct320SpecificData=new o(e.paymentProduct320SpecificData)),e.paymentProduct863SpecificData&&(n.paymentProduct863SpecificData=new s(e.paymentProduct863SpecificData))}(e,this,this.accountsOnFile,this.accountOnFileById)};return e.BasicPaymentProduct=r,r}),define("connectsdk.BasicPaymentProductGroup",["connectsdk.core","connectsdk.AccountOnFile","connectsdk.PaymentProductDisplayHints"],function(e,t,n){var i=function(e){this.json=e,this.json.type="group",this.id=e.id,this.displayHints=new n(e.displayHints),this.accountsOnFile=[],this.accountOnFileById={},function(e,n,i){if(e.accountsOnFile)for(var o=0,s=e.accountsOnFile.length;o<s;o++){var r=new t(e.accountsOnFile[o]);n.push(r),i[r.id]=r}}(e,this.accountsOnFile,this.accountOnFileById)};return e.BasicPaymentProductGroup=i,i}),define("connectsdk.MaskedString",["connectsdk.core"],function(e){var t=function(e,t){this.formattedValue=e,this.cursorIndex=t};return e.MaskedString=t,t}),define("connectsdk.MaskingUtil",["connectsdk.core","connectsdk.MaskedString"],function(e,t){var n=function(e,t,i,o,s){e+t<s.length&&e<o.length&&("9"===o[e]&&Number(s[e+t])>-1&&" "!==s[e+t]||"*"===o[e]?i.push(s[e+t]):s[e+t]===o[e]?i.push(s[e+t]):"9"!==o[e]&&"*"!==o[e]?(i.push(o[e]),t--):(s.splice(e+t,1),e--),n(e+1,t,i,o,s))},i=function(){this.applyMask=function(e,i,o){var s=[],r=i.split("");if(e){for(var c=e.split(""),a=[],u=0,d=c.length;u<d;u++){"{"===(l=c[u])||"}"===l||a.push(l)}n(0,0,s,a,r)}else for(u=0,d=r.length;u<d;u++){var l=r[u];s.push(l)}i=s.join("");var p=1;if(o){var h=o.split("");for(u=0,d=s.length;u<d;u++)if(s[u]!==h[u]){p=u+1;break}}return i.substring(0,i.length-1)===o&&(p=i.length+1),new t(i,p)},this.getMaxLengthBasedOnMask=function(e){if(e){for(var t=e.split(""),n=-1,i=0,o=t.length;i<o;i++){n++;var s=t[i];"{"!==s&&"}"!==s||n--}return n}},this.removeMask=function(e,t){var n=[],i=t?t.split(""):[];if(e)for(var o=e.split(""),s=-1,r=!1,c=0,a=o.length;c<a;c++){s++,"{"===(u=o[c])||"}"===u?(s--,"{"===u?r=!0:"}"===u&&(r=!1)):r&&i[s]&&n.push(i[s])}else for(c=0,a=i.length;c<a;c++){var u=i[c];n.push(u)}return n.join("").trim()}};return e.MaskingUtil=i,i}),define("connectsdk.ValidationRuleLuhn",["connectsdk.core"],function(e){var t=function(e){this.json=e,this.type=e.type,this.errorMessageId=e.type,this.validate=function(e){var t=[[0,2,4,6,8,1,3,5,7,9],[0,1,2,3,4,5,6,7,8,9]],n=0;return e.replace(/\D+/g,"").replace(/[\d]/g,function(e,i,o){n+=t[o.length-i&1][parseInt(e,10)]}),n%10==0&&n>0}};return e.ValidationRuleLuhn=t,t}),define("connectsdk.ValidationRuleExpirationDate",["connectsdk.core"],function(e){var t=function(e){this.json=e,this.type=e.type,this.errorMessageId=e.type,this.validate=function(e){if(!function(e){return/\d{4}|\d{6}$/g.test(e)}(e=e.replace(/[^\d]/g,"")))return!1;var t;if(4===e.length)t=[e.substring(0,2),"20"+e.substring(2,4)];else{if(6!==e.length)return!1;t=[e.substring(0,2),e.substring(2,6)]}var n=t[0]-1,i=t[1],o=new Date(i,n,1);if(o.getMonth()!==Number(n)||o.getFullYear()!==Number(i))return!1;var s=new Date,r=new Date(s.getFullYear(),s.getMonth(),1),c=new Date(s.getFullYear()+25,11,1);return o>=r&&o<=c}};return e.ValidationRuleExpirationDate=t,t}),define("connectsdk.ValidationRuleFixedList",["connectsdk.core"],function(e){var t=function(e){this.json=e,this.type=e.type,this.errorMessageId=e.type,this.allowedValues=e.attributes.allowedValues,this.validate=function(e){for(var t=0,n=this.allowedValues.length;t<n;t++)if(this.allowedValues[t]===e)return!0;return!1}};return e.ValidationRuleFixedList=t,t}),define("connectsdk.ValidationRuleLength",["connectsdk.core"],function(e){var t=function(e){this.json=e,this.type=e.type,this.errorMessageId=e.type,this.maxLength=e.attributes.maxLength,this.minLength=e.attributes.minLength,this.validate=function(e){return this.minLength<=e.length&&e.length<=this.maxLength}};return e.ValidationRuleLength=t,t}),define("connectsdk.ValidationRuleRange",["connectsdk.core"],function(e){var t=function(e){this.json=e,this.type=e.type,this.errorMessageId=e.type,this.maxValue=e.attributes.maxValue,this.minValue=e.attributes.minValue,this.validate=function(e){return!isNaN(e)&&(e=Number(e),this.minValue<=e&&e<=this.maxValue)}};return e.ValidationRuleRange=t,t}),define("connectsdk.ValidationRuleRegularExpression",["connectsdk.core"],function(e){var t=function(e){this.json=e,this.type=e.type,this.errorMessageId=e.type,this.regularExpression=e.attributes.regularExpression,this.validate=function(e){return new RegExp(this.regularExpression).test(e)}};return e.ValidationRuleRegularExpression=t,t}),define("connectsdk.ValidationRuleResidentIdNumber",["connectsdk.core"],function(e){var t=function(e){this.json=e,this.type=e.type,this.errorMessageId=e.type;for(var t=[],n=18;n>0;n--)t.push(Math.pow(2,n-1)%11);this.validate=function(e){if(e.length<15)return!1;if(15==e.length)return!isNaN(e);if(e.length<18||e.length>18)return!1;for(var n=0,i=0;i<e.length-1;i++)n+=e.charAt(i)*t[i];var o=(12-n%11)%11,s=e.charAt(17);return o<10?o==s:"X"===s}};return e.ValidationRuleResidentIdNumber=t,t}),define("connectsdk.ValidationRuleEmailAddress",["connectsdk.core"],function(e){var t=function(e){this.json=e,this.type=e.type,this.errorMessageId=e.type,this.validate=function(e){return new RegExp(/^[^@\.]+(\.[^@\.]+)*@([^@\.]+\.)*[^@\.]+\.[^@\.][^@\.]+$/i).test(e)}};return e.ValidationRuleEmailAddress=t,t}),define("connectsdk.ValidationRuleTermsAndConditions",["connectsdk.core"],function(e){var t=function(e){this.json=e,this.type=e.type,this.errorMessageId=e.type,this.validate=function(e){return!0===e||"true"===e}};return e.ValidationRuleTermsAndConditions=t,t}),define("connectsdk.ValidationRuleBoletoBancarioRequiredness",["connectsdk.core"],function(e){var t=function(e){this.json=e,this.type=e.type,this.errorMessageId=e.type,this.fiscalNumberLength=e.attributes.fiscalNumberLength,this.validate=function(e,t){return void 0===t&&(t=""),t.length===this.fiscalNumberLength&&e.length>0||t.length!==this.fiscalNumberLength}};return e.ValidationRuleBoletoBancarioRequiredness=t,t}),define("connectsdk.ValidationRuleIban",["connectsdk.core"],function(e){var t=function(e){return e.replace(/[^\d\w]+/g,"").toUpperCase()},n=function(e){this.json=e,this.type=e.type,this.errorMessageId=e.type,this.validate=function(e){if(!function(e){return"string"==typeof e&&/^[A-Z]{2}[0-9]{2}[A-Z0-9]{4}[0-9]{7}([A-Z0-9]?){0,16}$/.test(t(e))}(e))return!1;for(var n,i=function(e){return t(e).replace(/(^.{4})(.*)/,"$2$1").replace(/[A-Z]/g,function(e){return e.charCodeAt(0)-55})}(e);i.length>2;)n=i.slice(0,9),i=parseInt(n,10)%97+i.slice(n.length);return parseInt(i,10)%97==1}};return e.ValidationRuleIban=n,n}),define("connectsdk.ValidationRuleFactory",["connectsdk.core","connectsdk.ValidationRuleEmailAddress","connectsdk.ValidationRuleTermsAndConditions","connectsdk.ValidationRuleExpirationDate","connectsdk.ValidationRuleFixedList","connectsdk.ValidationRuleLength","connectsdk.ValidationRuleLuhn","connectsdk.ValidationRuleRange","connectsdk.ValidationRuleRegularExpression","connectsdk.ValidationRuleBoletoBancarioRequiredness","connectsdk.ValidationRuleIban","connectsdk.ValidationRuleResidentIdNumber"],function(e,t,n,i,o,s,r,c,a,u,d,l){var p={EmailAddress:t,TermsAndConditions:n,ExpirationDate:i,FixedList:o,Length:s,Luhn:r,Range:c,RegularExpression:a,BoletoBancarioRequiredness:u,Iban:d,ResidentIdNumber:l},h=function(){this.makeValidator=function(e){try{var t=e.type.charAt(0).toUpperCase()+e.type.slice(1);return new p[t](e)}catch(e){console.warn("no validator for ",t)}return null}};return e.ValidationRuleFactory=h,h}),define("connectsdk.DataRestrictions",["connectsdk.core","connectsdk.ValidationRuleExpirationDate","connectsdk.ValidationRuleFixedList","connectsdk.ValidationRuleLength","connectsdk.ValidationRuleLuhn","connectsdk.ValidationRuleRange","connectsdk.ValidationRuleRegularExpression","connectsdk.ValidationRuleEmailAddress","connectsdk.ValidationRuleTermsAndConditions","connectsdk.ValidationRuleIban","connectsdk.ValidationRuleResidentIdNumber","connectsdk.ValidationRuleFactory"],function(e,t,n,i,o,s,r,c,a,u,d,l){var p=function(e,t){this.json=e,this.isRequired=e.isRequired,this.validationRules=[],this.validationRuleByType={},function(e,t,n){var i=new l;if(e.validators)for(var o in e.validators){var s=i.makeValidator({type:o,attributes:e.validators[o]});s&&(t.push(s),n[s.type]=s)}}(e,this.validationRules,this.validationRuleByType)};return e.DataRestrictions=p,p}),define("connectsdk.ValueMappingElement",["connectsdk.core"],function(e){var t=function(e){this.json=e,this.displayName=e.displayName,this.value=e.value};return e.ValueMappingElement=t,t}),define("connectsdk.FormElement",["connectsdk.core","connectsdk.ValueMappingElement"],function(e,t){var n=function(e){this.json=e,this.type=e.type,this.valueMapping=[],function(e,n){if(e.valueMapping)for(var i=0,o=e.valueMapping.length;i<o;i++)n.push(new t(e.valueMapping[i]))}(e,this.valueMapping)};return e.FormElement=n,n}),define("connectsdk.Tooltip",["connectsdk.core"],function(e){var t=function(e){this.json=e,this.image=e.image,this.label=e.label};return e.Tooltip=t,t}),define("connectsdk.PaymentProductFieldDisplayHints",["connectsdk.core","connectsdk.Tooltip","connectsdk.FormElement"],function(e,t,n){var i=function(e){this.json=e,this.displayOrder=e.displayOrder,e.formElement&&(this.formElement=new n(e.formElement)),this.label=e.label,this.mask=e.mask,this.obfuscate=e.obfuscate,this.placeholderLabel=e.placeholderLabel,this.preferredInputType=e.preferredInputType,this.tooltip=e.tooltip?new t(e.tooltip):void 0,this.alwaysShow=e.alwaysShow,this.wildcardMask=e.mask?e.mask.replace(/9/g,"*"):""};return e.PaymentProductFieldDisplayHints=i,i}),define("connectsdk.PaymentProductField",["connectsdk.core","connectsdk.PaymentProductFieldDisplayHints","connectsdk.DataRestrictions","connectsdk.MaskingUtil"],function(e,t,n,i){var o=function(e){this.json=e,this.displayHints=e.displayHints?new t(e.displayHints):"",this.dataRestrictions=new n(e.dataRestrictions,this.displayHints?this.displayHints.mask:""),this.id=e.id,this.type=e.type;var o=[];this.getErrorCodes=function(e){return e&&(o=[],this.isValid(e)),o},this.isValid=function(e){var t=this.dataRestrictions.validationRules,n=!1,i=this.applyMask(e);e=this.removeMask(i.formattedValue);for(var s=0,r=t.length;s<r;s++){var c=t[s];c.validate(e)||(n=!0,o.push(c.errorMessageId))}return!n},this.applyMask=function(e,t){return(new i).applyMask(this.displayHints.mask,e,t)},this.applyWildcardMask=function(e,t){return(new i).applyMask(this.displayHints.wildcardMask,e,t)},this.removeMask=function(e){return(new i).removeMask(this.displayHints.mask,e)}};return e.PaymentProductField=o,o}),define("connectsdk.PaymentProduct",["connectsdk.core","connectsdk.BasicPaymentProduct","connectsdk.PaymentProductField"],function(e,t,n){var i=function(e){var i=new t(e);return i.paymentProductFields=[],i.paymentProductFieldById={},function(e,t,i){if(e.fields)for(var o=0,s=e.fields.length;o<s;o++){var r=new n(e.fields[o]);t.push(r),i[r.id]=r}}(i.json,i.paymentProductFields,i.paymentProductFieldById),i};return e.PaymentProduct=i,i}),define("connectsdk.PaymentProductGroup",["connectsdk.core","connectsdk.BasicPaymentProduct","connectsdk.PaymentProductField"],function(e,t,n){var i=function(e){var i=new t(e);return i.json=e,i.json.type="group",i.paymentProductFields=[],i.paymentProductFieldById={},function(e,t,i){if(e.fields)for(var o=0,s=e.fields.length;o<s;o++){var r=new n(e.fields[o]);t.push(r),i[r.id]=r}}(i.json,i.paymentProductFields,i.paymentProductFieldById),i};return e.PaymentProductGroup=i,i}),define("connectsdk.BasicPaymentProducts",["connectsdk.core","connectsdk.BasicPaymentProduct"],function(e,t){var n=function(e){this.basicPaymentProducts=[],this.basicPaymentProductById={},this.basicPaymentProductByAccountOnFileId={},this.accountsOnFile=[],this.accountOnFileById={},this.json=e,function(e,n,i,o,s,r){if(e.paymentProducts)for(var c=0,a=e.paymentProducts.length;c<a;c++){var u=new t(e.paymentProducts[c]);if(n.push(u),o[u.id]=u,u.accountsOnFile)for(var d=u.accountsOnFile,l=0,p=d.length;l<p;l++){var h=d[l];i.push(h),s[h.id]=h,r[h.id]=u}}}(e,this.basicPaymentProducts,this.accountsOnFile,this.basicPaymentProductById,this.accountOnFileById,this.basicPaymentProductByAccountOnFileId)};return e.BasicPaymentProducts=n,n}),define("connectsdk.BasicPaymentProductGroups",["connectsdk.core","connectsdk.BasicPaymentProductGroup"],function(e,t){var n=function(e){this.basicPaymentProductGroups=[],this.basicPaymentProductGroupById={},this.accountsOnFile=[],this.accountOnFileById={},this.json=e,function(e,n,i,o,s){if(e.paymentProductGroups)for(var r=0,c=e.paymentProductGroups.length;r<c;r++){var a=new t(e.paymentProductGroups[r]);if(n.push(a),o[a.id]=a,a.accountsOnFile)for(var u=a.accountsOnFile,d=0,l=u.length;d<l;d++){var p=u[d];i.push(p),s[p.id]=p}}}(e,this.basicPaymentProductGroups,this.accountsOnFile,this.basicPaymentProductGroupById,this.accountOnFileById)};return e.BasicPaymentProductGroups=n,n}),define("connectsdk.BasicPaymentItems",["connectsdk.core"],function(e){"use strict";var t=function(e,t){this.basicPaymentItems=[],this.basicPaymentItemById={},this.accountsOnFile=[],this.accountOnFileById={},function(e,t,n){var i=[];if(t){for(var o=0,s=t.basicPaymentProductGroups.length;o<s;o++)for(var r=t.basicPaymentProductGroups[o].id,c=!1,a=0,u=e.basicPaymentProducts.length;a<u;a++){var d=e.basicPaymentProducts[a].paymentProductGroup;d===r&&!1===c?(e.basicPaymentProducts.splice(a,1,t.basicPaymentProductGroups[o]),c=!0):d===r&&!0===c&&i.push(a)}for(o=i.length-1,s=0;o>=s;o--)e.basicPaymentProducts.splice(i[o],1)}n.basicPaymentItems=JSON.parse(JSON.stringify(e.basicPaymentProducts));for(o=0,s=n.basicPaymentItems.length;o<s;o++){var l=n.basicPaymentItems[o];if(n.basicPaymentItemById[l.id]=l,l.accountsOnFile){var p=l.accountsOnFile;for(a=0,u=p.length;a<u;a++){var h=p[a];n.accountsOnFile.push(h),n.accountOnFileById[h.id]=h}}}}(e,t,this)};return e.BasicPaymentItems=t,t}),define("connectsdk.PaymentRequest",["connectsdk.core"],function(e){var t=function(e){var t={},n=null,i=null,o=!1;this.isValid=function(){var e=this.getErrorMessageIds(),t=this.getPaymentProduct();if(!t)return!1;for(var n=!0,i=0;i<t.paymentProductFields.length;i++){var o=t.paymentProductFields[i];if(o.dataRestrictions.isRequired)this.getValue(o.id)||this.getAccountOnFile()||(n=!1)}return 0===e.length&&n},this.setValue=function(e,n){t[e]=n},this.setTokenize=function(e){o=e},this.getTokenize=function(){return o},this.getErrorMessageIds=function(){var e=[];for(key in t){var i=n.paymentProductFieldById[key];i&&(e=e.concat(i.getErrorCodes(t[key])))}return e},this.getValue=function(e){return t[e]},this.getValues=function(){return t},this.getMaskedValue=function(e){return n.paymentProductFieldById[e].applyMask(this.getValue(e)).formattedValue()},this.getMaskedValues=function(){var e=t,i=[];for(var o in e){var s=n.paymentProductFieldById[o].applyMask(this.getValue(o));i[o]=s.formattedValue}return i},this.getUnmaskedValues=function(){var e=t,i=[];for(var o in e){var s=n.paymentProductFieldById[o];if(s){var r=s.applyMask(this.getValue(o)).formattedValue;i[o]=s.removeMask(r)}}return i},this.setPaymentProduct=function(e){"group"!==e.type&&(n=e)},this.getPaymentProduct=function(){return n},this.setAccountOnFile=function(e){for(var n=0,o=e.attributes.length;n<o;n++){var s=e.attributes[n];delete t[s.key]}i=e},this.getAccountOnFile=function(){return i},this.getClientSessionID=function(){return e}};return e.PaymentRequest=t,t}),define("connectsdk.C2SPaymentProductContext",["connectsdk.core"],function(e){var t=function(e){this.totalAmount=void 0!==e.totalAmount?e.totalAmount:"",this.countryCode=e.countryCode,this.isRecurring=void 0!==e.isRecurring?e.isRecurring:"",this.currency=e.currency,void 0!==e.locale&&(this.locale=e.locale),void 0!==e.accountOnFileId&&(this.accountOnFileId=parseInt(e.accountOnFileId))};return e.C2SPaymentProductContext=t,t}),define("connectsdk.JOSEEncryptor",["connectsdk.core"],function(e){var t=forge.pki,n=(forge.asn1,function(e){return e=(e=(e=(e=forge.util.encode64(e)).split("=")[0]).replace(/\+/g,"-")).replace(/\//g,"_")}),i=function(){this.encrypt=function(e,i){var o,s,r,c,a,u,d=JSON.stringify(e),l=(o=i.keyId,s={alg:"RSA-OAEP",enc:"A256CBC-HS512",kid:o},JSON.stringify(s)),p=n(l),h=forge.random.getBytesSync(64),f=function(e,t){return t.encrypt(e,"RSA-OAEP")}(h,(r=i.publicKey,c=forge.util.decode64(r),a=forge.util.createBuffer(c,"raw"),u=forge.asn1.fromDer(a),t.publicKeyFromAsn1(u))),y=n(f),m=h.substring(0,32),g=h.substring(32),P=forge.random.getBytesSync(16),v=n(P),k=function(e,t,n){var i=forge.cipher.createCipher("AES-CBC",t);return i.start({iv:n}),i.update(forge.util.createBuffer(e)),i.finish(),i.output.bytes()}(d,g,P),S=n(k),I=function(e,t,n,i,o){var s=forge.util.createBuffer();s.putBytes(t),s.putBytes(n),s.putBytes(i),s.putBytes(o);var r=s.bytes(),c=forge.hmac.create();return c.start(forge.sha512.create(),e),c.update(r),c.digest().bytes()}(m,p,P,k,function(e){var t=8*forge.util.createBuffer(e).length(),n=forge.util.createBuffer();return n.putInt32(0),n.putInt32(t),n.bytes()}(p)),w=I.substring(0,I.length/2);return p+"."+y+"."+v+"."+S+"."+n(w)}};return e.JOSEEncryptor=i,i}),define("connectsdk.Encryptor",["connectsdk.core","connectsdk.promise","connectsdk.JOSEEncryptor","connectsdk.Util"],function(e,t,n,i){var o=i.getInstance(),s=function(e){this.encrypt=function(i){var s=new t,r="";return e.then(function(e){if(i.isValid()){var t={clientSessionId:i.getClientSessionID(),nonce:forge.util.bytesToHex(forge.random.getBytesSync(16)),paymentProductId:i.getPaymentProduct().id,tokenize:i.getTokenize()};i.getAccountOnFile()&&(t.accountOnFileId=i.getAccountOnFile().id);for(var c=[],a=i.getUnmaskedValues(),u=Object.getOwnPropertyNames(a),d=0;d<u.length;d++){var l=u[d];"length"!==l&&c.push({key:l,value:a[l]})}t.paymentValues=c,t.collectedDeviceInformation=o.collectDeviceInformation();var p=new n;r=p.encrypt(t,e),s.resolve(r)}else s.reject(i.getErrorMessageIds())},function(e){s.reject(e)}),s}};return e.Encryptor=s,s}),define("connectsdk.Session",["connectsdk.core","connectsdk.C2SCommunicator","connectsdk.C2SCommunicatorConfiguration","connectsdk.IinDetailsResponse","connectsdk.promise","connectsdk.C2SPaymentProductContext","connectsdk.BasicPaymentProducts","connectsdk.BasicPaymentProductGroups","connectsdk.PaymentProduct","connectsdk.PaymentProductGroup","connectsdk.BasicPaymentItems","connectsdk.PaymentRequest","connectsdk.Encryptor"],function(e,t,n,i,o,s,r,c,a,u,d,l,p){var h=function(e,i){var h,f,y,m,g=new n(e,"client/v1"),P=new t(g,i),v=this;this.clientApiUrl=g.clientApiUrl,this.assetUrl=g.assetUrl,this.getBasicPaymentProducts=function(e,t){var n=new o,i=new s(e);return P.getBasicPaymentProducts(i,t).then(function(t){f=e;var i=new r(t);n.resolve(i)},function(){n.reject()}),n},this.getBasicPaymentProductGroups=function(e){var t=new o,n=new s(e);return P.getBasicPaymentProductGroups(n).then(function(n){f=e;var i=new c(n);t.resolve(i)},function(){t.reject()}),t},this.getBasicPaymentItems=function(e,t,n){var i=new o;return t?v.getBasicPaymentProducts(e,n).then(function(t){v.getBasicPaymentProductGroups(e).then(function(e){var n=new d(t,e);i.resolve(n)},function(){i.reject()})},function(){i.reject()}):v.getBasicPaymentProducts(e,n).then(function(e){var t=new d(e,null);i.resolve(t)},function(){i.reject()}),i},this.getPaymentProduct=function(e,t,n){var i=new o;e;var r=new s(f||t);return P.getPaymentProduct(e,r,n).then(function(e){h=new a(e),i.resolve(h)},function(){h=null,i.reject()}),i},this.getPaymentProductGroup=function(e,t){var n=new o;e;var i=new s(f||t);return P.getPaymentProductGroup(e,i).then(function(e){m=new u(e),n.resolve(m)},function(){m=null,n.reject()}),n},this.getIinDetails=function(e,t){e=e.replace(/ /g,"").substring(0,6);var n=new s(f||t);return P.getPaymentProductIdByCreditCardNumber(e,n)},this.getPublicKey=function(){return P.getPublicKey()},this.getPaymentProductNetworks=function(e,t){var n=new o,i=new s(t);return P.getPaymentProductNetworks(e,i).then(function(e){f=t,n.resolve(e)},function(){n.reject()}),n},this.getPaymentProductDirectory=function(e,t,n){return P.getPaymentProductDirectory(e,t,n)},this.convertAmount=function(e,t,n){return P.convertAmount(e,t,n)},this.getPaymentRequest=function(){return y||(y=new l(g.clientSessionId)),y},this.getEncryptor=function(){var e=P.getPublicKey();return new p(e)},this.getThirdPartyPaymentStatus=function(e){var t=new o;return P.getThirdPartyPaymentStatus(e).then(function(e){t.resolve(e)},function(){t.reject()}),t},this.getCustomerDetails=function(e,t){return P.getCustomerDetails(e,t)},this.transformPaymentProductJSON=function(e){return new a(P.transformPaymentProductJSON(e))},this.transformPaymentProductGroupJSON=function(e){return new u(P.transformPaymentProductJSON(e))}};return e.Session=h,h});
//# sourceMappingURL=connectsdk.noEncrypt.min.js.map
