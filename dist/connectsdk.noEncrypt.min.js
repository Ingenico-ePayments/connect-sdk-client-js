!function(t){var e={},n={};e.define=function(t,e,i){if(e&&e.length)for(var o=0;o<e.length;o++)e[o]=n[e[o]];n[t]=i.apply(this,e||[])},t.connectsdk=e,"undefined"!=typeof exports&&(exports.connectsdk=e),e.define("connectsdk.core",[],function(){return e}),"undefined"==typeof define&&(t.define=e.define)}("undefined"==typeof window?this:window),define("connectsdk.core",[],function(){var t="undefined"==typeof window?this:window,e={};return t.connectsdk=e,"undefined"!=typeof exports&&(exports.connectsdk=e),e}),define("connectsdk.promise",["connectsdk.core"],function(t){return function(t){function e(t){var e=this;this.pending=[],this.resolve=function(t){e.complete("resolve",t)},this.reject=function(t){e.complete("reject",t)},t&&(this.isSingleton=!0)}e.prototype={then:function(t,e){return this.pending.push({resolve:t,reject:e}),this},complete:function(t,e){for(;this.pending[0];)this.pending.shift()[t](e)}},t.Promise=e}(connectsdk),connectsdk.Promise}),define("connectsdk.net",["connectsdk.core"],function(t){function e(){if(!("undefined"==typeof XMLHttpRequest||"file:"===window.location.protocol&&window.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(t){}return!1}function n(t){return t.status>=200&&t.status<300||304==t.status||0==t.status&&t.responseText}function i(i,o){function r(t){if(4==l.readyState){var e=l.mimeType||l.getResponseHeader("content-type")||"";if(p.status=l.status,p.responseText=l.responseText,/json/.test(e)?p.responseJSON=s.parseJSON(l.responseText):/xml/.test(e)&&(p.responseXML=s.parseXML(l.responseText)),p.success=n(l),o.callback)return o.callback(p,l);p.success?(o.success&&o.success(p,l),u&&u.resolve(p,l)):(o.error&&o.error(p,l),u&&u.reject(p,l))}}function c(){var t={Accept:"text/javascript, application/json, text/html, application/xml, text/xml, */*","Content-Type":"application/json"};for(var e in t)o.headers.hasOwnProperty(e)||(o.headers[e]=t[e]);for(var e in o.headers)l.setRequestHeader(e,o.headers[e])}function a(){try{c(),l.send(o.postBody)}catch(t){o.error&&o.error()}}var u,d,l=e(),p={};return t.Promise&&(u=new t.Promise),void 0===o&&(o={}),o.method=o.method?o.method.toLowerCase():"get",o.asynchronous=o.asynchronous||!0,o.postBody=o.postBody||"",l.onreadystatechange=r,l.open(o.method,i,o.asynchronous),o.headers=o.headers||{},o.contentType&&(o.headers["Content-Type"]=o.contentType),"string"!=typeof o.postBody&&(o.postBody=s.serialize(o.postBody)),d={set:function(t,e){return o.headers[t]=e,d},send:function(t,e){return o.postBody=s.serialize(t),o.callback=e,a(),d},end:function(t){return o.callback=t,a(),d},data:function(t){return o.postBody=s.serialize(t),d},then:function(){return d.end(),u&&u.then.apply(u,arguments),d}}}function o(t,e,n){function i(t){o.success(t),o.teardown()}var o=this;this.url=t,this.methodName="__connectsdk_jsonp_"+parseInt((new Date).getTime()),this.success=e,this.failure=n,window[this.methodName]=i}var s={},r="".trim?function(t){return t.trim()}:function(t){return t.replace(/^\s\s*/,"").replace(/\s\s*$/,"")};return s.serialize=function(t){if(t){if("string"==typeof t)return t;var e=[];for(var n in t)e.push(encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e.join("&")}},s.parseJSON=function(t){return"string"==typeof t&&t?(t=r(t),window.JSON.parse(t)):null},window.DOMParser?s.parseXML=function(t){return(new DOMParser).parseFromString(t,"text/xml")}:s.parseXML=function(t){var e=new ActiveXObject("Microsoft.XMLDOM");return e.async="false",e.loadXML(t),e},o.prototype.run=function(){this.scriptTag=document.createElement("script"),this.scriptTag.id=this.methodName,this.scriptTag.src=this.url.replace("{callback}",this.methodName);var t=this;this.scriptTag.onerror=function(){t.failure()},document.body.appendChild(this.scriptTag)},o.prototype.teardown=function(){window[this.methodName]=null;try{delete window[this.methodName]}catch(t){}this.scriptTag&&document.body.removeChild(this.scriptTag)},s.get=function(t,e){return void 0===e&&(e={}),e.method="get",i(t,e)},s.post=function(t,e){return void 0===e&&(e={}),e.method="post",i(t,e)},s.jsonp=function(t,e){void 0===e&&(e={}),new o(t,e.success,e.failure).run()},t.get=s.get,t.post=s.post,t.jsonp=s.jsonp,s.ajax=i,t.net=s,s}),define("connectsdk.Util",["connectsdk.core"],function(t){var e=function(){function t(){return{applePayPaymentProductId:302,androidPayPaymentProductId:320,bancontactPaymentProductId:3012,getMetadata:function(){return{screenSize:window.innerWidth+"x"+window.innerHeight,platformIdentifier:window.navigator.userAgent,sdkIdentifier:(document.GC&&document.GC.rppEnabledPage?"rpp-":"")+"JavaScriptClientSDK/v3.10.0",sdkCreator:"Ingenico"}},base64Encode:function(t){if("object"==typeof t)try{t=JSON.stringify(t)}catch(t){throw"data must be either a String or a JSON object"}var e,n,i,o,s,r,c,a,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",d=0,l=0,p="",h=[];if(!t)return t;do{e=t.charCodeAt(d++),n=t.charCodeAt(d++),i=t.charCodeAt(d++),a=e<<16|n<<8|i,o=a>>18&63,s=a>>12&63,r=a>>6&63,c=63&a,h[l++]=u.charAt(o)+u.charAt(s)+u.charAt(r)+u.charAt(c)}while(d<t.length);p=h.join("");var y=t.length%3;return(y?p.slice(0,y-3):p)+"===".slice(y||3)},filterOutProductsThatAreNotSupportedInThisBrowser:function(t){for(var e=t.paymentProducts.length-1;e>=0;e--){var n=t.paymentProducts[e];n&&this.paymentProductsThatAreNotSupportedInThisBrowser.indexOf(n.id)>-1&&t.paymentProducts.splice(e,1)}},paymentProductsThatAreNotSupportedInThisBrowser:[302]}}var e;return{getInstance:function(){return e||(e=t()),e}}}();return t.Util=e,e}),define("connectsdk.AndroidPay",["connectsdk.core","connectsdk.promise","connectsdk.Util"],function(t,e,n){var i=n.getInstance(),o=null,s=null,r=null,c=function(t,e){var n="TEST";return"PROD"===r.environment&&(n="PROD"),[{supportedMethods:["https://android.com/pay"],data:{merchantId:s.androidPay.merchantId,environment:n,allowedCardNetworks:t,paymentMethodTokenizationParameters:{tokenizationType:"NETWORK_TOKEN",parameters:{publicKey:e}}}}]},a=function(){var t=(r.totalAmount/100).toFixed(2);return{total:{label:"Total",amount:{currency:r.currency,value:t}}}},u=function(){return{requestShipping:!1,requestPayerEmail:!1,requestPayerPhone:!1,requestPayerName:!1}},d=function(t,n){var i=new e,o=c(t.networks,n.publicKey),s=a(),r=u(),d=new PaymentRequest(o,s,r);return setTimeout(function(){d.canMakePayment?d.canMakePayment().then(function(t){t?i.resolve(!0):i.resolve(!1)}).catch(function(t){i.reject(t)}):i.resolve(!0)}),i},l=function(){var t=new e;return o.getPaymentProductPublicKey(i.androidPayPaymentProductId).then(function(e){t.resolve(e)},function(){t.reject()}),t},p=function(){var t=new e;return o.getPaymentProductNetworks(i.androidPayPaymentProductId,r).then(function(e){e.networks&&e.networks.length>0?t.resolve(e):t.reject()},function(){t.reject()}),t},h=function(){return window&&window.PaymentRequest},y=function(t){o=t,this.isAndroidPayAvailable=function(t,n){r=t,s=n;var o=new e;return setTimeout(function(){h()?p().then(function(t){l().then(function(e){d(t,e).then(function(t){t||i.paymentProductsThatAreNotSupportedInThisBrowser.push(i.androidPayPaymentProductId),o.resolve(t)},function(){i.paymentProductsThatAreNotSupportedInThisBrowser.push(i.androidPayPaymentProductId),o.reject("failed to run canMakePayment() check with the payment request API")})},function(){i.paymentProductsThatAreNotSupportedInThisBrowser.push(i.androidPayPaymentProductId),o.reject("failed to retrieve payment product publickey")})},function(){i.paymentProductsThatAreNotSupportedInThisBrowser.push(i.androidPayPaymentProductId),o.reject("failed to retrieve paymentproduct networks")}):(i.paymentProductsThatAreNotSupportedInThisBrowser.push(i.androidPayPaymentProductId),o.reject("Payment Request API is not available"))}),o},this.isMerchantIdProvided=function(t){return t.androidPay.merchantId?t.androidPay.merchantId:(i.paymentProductsThatAreNotSupportedInThisBrowser.push(i.androidPayPaymentProductId),!1)}};return t.AndroidPay=y,y}),define("connectsdk.PublicKeyResponse",["connectsdk.core"],function(t){var e=function(t){this.json=t,this.keyId=t.keyId,this.publicKey=t.publicKey};return t.PublicKeyResponse=e,e}),define("connectsdk.PaymentProductPublicKeyResponse",["connectsdk.core"],function(t){var e=function(t){this.json=t,this.keyId=t.keyId,this.publicKey=t.publicKey};return t.PaymentProductPublicKeyResponse=e,e}),define("connectsdk.C2SCommunicatorConfiguration",["connectsdk.core"],function(t){var e=function(t,e){if(this.endpoints={PROD:{EU:{API:"https://ams1.api-ingenico.com/client/v1",ASSETS:"https://assets.pay1.secured-by-ingenico.com"},US:{API:"https://us.api-ingenico.com/client/v1",ASSETS:"https://assets.pay2.secured-by-ingenico.com"},AMS:{API:"https://ams2.api-ingenico.com/client/v1",ASSETS:"https://assets.pay3.secured-by-ingenico.com"},PAR:{API:"https://par.api-ingenico.com/client/v1",ASSETS:"https://assets.pay4.secured-by-ingenico.com"}},PREPROD:{EU:{API:"https://ams1.preprod.api-ingenico.com/client/v1",ASSETS:"https://assets.pay1.preprod.secured-by-ingenico.com"},US:{API:"https://us.preprod.api-ingenico.com/client/v1",ASSETS:"https://assets.pay2.preprod.secured-by-ingenico.com"},AMS:{API:"https://ams2.preprod.api-ingenico.com/client/v1",ASSETS:"https://assets.pay3.preprod.secured-by-ingenico.com"},PAR:{API:"https://par-preprod.api-ingenico.com/client/v1",ASSETS:"https://assets.pay4.preprod.secured-by-ingenico.com"}},SANDBOX:{EU:{API:"https://ams1.sandbox.api-ingenico.com/client/v1",ASSETS:"https://assets.pay1.sandbox.secured-by-ingenico.com"},US:{API:"https://us.sandbox.api-ingenico.com/client/v1",ASSETS:"https://assets.pay2.sandbox.secured-by-ingenico.com"},AMS:{API:"https://ams2.sandbox.api-ingenico.com/client/v1",ASSETS:"https://assets.pay3.sandbox.secured-by-ingenico.com"},PAR:{API:"https://par.sandbox.api-ingenico.com/client/v1",ASSETS:"https://assets.pay4.sandbox.secured-by-ingenico.com"}},INTEGRATION:{EU:{API:"https://int-test-api.gcsip.nl:4443/client/v1",ASSETS:"https://assets.int-test-rpp.gcsip.nl:4443"},US:{API:"https://int-test-api.gcsip.nl:4443/client/v1",ASSETS:"https://assets.int-test-rpp.gcsip.nl:4443"},AMS:{API:"https://int-test-api.gcsip.nl:4443/client/v1",ASSETS:"https://assets.int-test-rpp.gcsip.nl:4443"},PAR:{API:"https://int-test-api.gcsip.nl:4443/client/v1",ASSETS:"https://assets.int-test-rpp.gcsip.nl:4443"}},DEV_NAMI:{EU:{API:"https://nami-test-api.gcsip.nl:4443/client/v1",ASSETS:"https://assets.nami-test-rpp.gcsip.nl:4443"},US:{API:"https://nami-test-api.gcsip.nl:4443/client/v1",ASSETS:"https://assets.nami-test-rpp.gcsip.nl:4443"},AMS:{API:"https://nami-test-api.gcsip.nl:4443/client/v1",ASSETS:"https://assets.nami-test-rpp.gcsip.nl:4443"},PAR:{API:"https://nami-test-api.gcsip.nl:4443/client/v1",ASSETS:"https://assets.nami-test-rpp.gcsip.nl:4443"}},DEV_ISC:{EU:{API:"//api.gc-dev.isaac.local/client/v1",ASSETS:"//rpp.gc-dev.isaac.local"},US:{API:"//api.gc-ci-dev.isaac.local/client/v1",ASSETS:"//rpp.gc-ci-dev.isaac.local"},AMS:{API:"//api.gc-dev.isaac.local/client/v1",ASSETS:"//rpp.gc-dev.isaac.local"},PAR:{API:"//api.gc-dev.isaac.local/client/v1",ASSETS:"//rpp.gc-dev.isaac.local"}}},t.clientSessionId){if(t.clientSessionID)throw new Error("You cannot use both the clientSessionId and the clientSessionID at the same time, please use the clientSessionId only.")}else t.clientSessionId=t.clientSessionID;if(t.assetUrl){if(t.assetsBaseUrl)throw new Error("You cannot use both the assetUrl and the assetsBaseUrl at the same time, please use the assetUrl only.")}else t.assetUrl=t.assetsBaseUrl;if(t.clientApiUrl){if(t.apiBaseUrl)throw new Error("You cannot use both the clientApiUrl and the apiBaseUrl at the same time, please use the clientApiUrl only.")}else t.clientApiUrl=t.apiBaseUrl;if(this.clientSessionId=t.clientSessionId,this.customerId=t.customerId,t.region&&!t.clientApiUrl)console.warn("Using regions is deprecated, switch to clientApiUrl"),this.clientApiUrl=this.endpoints[t.environment][t.region].API,this.assetUrl=this.endpoints[t.environment][t.region].ASSETS;else{if(this.clientApiUrl=t.clientApiUrl,this.assetUrl=t.assetUrl,!this.clientApiUrl)throw new Error("This version of the connectSDK requires an clientApiUrl, which you did not provide.");if(!this.assetUrl)throw new Error("This version of the connectSDK requires an assetUrl, which you did not provide.");if(-1===this.clientApiUrl.indexOf("//"))throw new Error("A valid URL is required for the clientApiUrl, you provided '"+this.clientApiUrl+"'");var n=this.clientApiUrl.split("/");if(""!==n[0]&&0!==n[0].indexOf("http"))throw new Error("A valid URL is required for the clientApiUrl, you provided '"+this.clientApiUrl+"'");var i=n.splice(3).join("/");if(i){if("client"===i)this.clientApiUrl+="/"+e.split("/")[1];else if(0!==i.indexOf(e)||i.length!==e.length)throw new Error("This version of the connectSDK is only compatible with "+e+", you supplied: '"+i+"'")}else this.clientApiUrl+="/"+e}};return t.C2SCommunicatorConfiguration=e,e}),define("connectsdk.IinDetailsResponse",["connectsdk.core","connectsdk.promise"],function(t,e){var n=function(){this.status="",this.countryCode="",this.paymentProductId="",this.isAllowedInContext="",this.coBrands=[]};return t.IinDetailsResponse=n,n}),define("connectsdk.C2SCommunicator",["connectsdk.core","connectsdk.promise","connectsdk.net","connectsdk.Util","connectsdk.PublicKeyResponse","connectsdk.PaymentProductPublicKeyResponse","connectsdk.IinDetailsResponse","connectsdk.AndroidPay"],function(t,e,n,i,o,s,r,c){var a=function(t,a){var u=t,d=i.getInstance(),l={},p=a,h=this,y=new c(h),f={expirydate:"tel",string:"text",numericstring:"tel",integer:"number",expirationDate:"tel"},m=function(t){return t&&P(t,"/")?t:t+"/"},P=function(t,e){return-1!==t.indexOf(e,t.length-e.length)},v=function(t,e){for(var n=0,i=t.fields.length;n<i;n++){var o=t.fields[n];o.type=o.displayHints.obfuscate?"password":f[o.type];for(validatorKey in o.dataRestrictions.validators)o.validators=o.validators||[],o.validators.push(validatorKey);o.displayHints.formElement&&"list"===o.displayHints.formElement.type&&(o.displayHints.formElement.list=!0),o.displayHints.tooltip&&o.displayHints.tooltip.image&&(o.displayHints.tooltip.image=m(e)+o.displayHints.tooltip.image)}return t.fields.sort(function(t,e){return t.displayHints.displayOrder<e.displayHints.displayOrder?-1:1}),t.displayHints.logo=m(e)+t.displayHints.logo,t},g=function(t,e,n){for(var i=0,o=t["paymentProduct"+n].length;i<o;i++){var s=t["paymentProduct"+n][i];s.displayHints.logo=m(e)+s.displayHints.logo}return t["paymentProduct"+n].sort(function(t,e){return t.displayHints.displayOrder<e.displayHints.displayOrder?-1:1}),t},k=function(t,e){for(var n=t.length-1;n>=0;n--){var i=t[n];if(i&&i.id===e)return!0}return!1},S=d.getMetadata();this.getBasicPaymentProducts=function(t,i){var o=t.locale?t.locale+"_":"",i=i||{},s=new e,r=(new Date).getTime(),c="getPaymentProducts-"+t.totalAmount+"_"+t.countryCode+"_"+o+t.isRecurring+"_"+t.currency+"_"+JSON.stringify(i);if(l[c])setTimeout(function(){s.resolve(l[c])},0);else{var a=t.locale?"&locale="+t.locale:"";n.get(m(u.clientApiUrl)+u.customerId+"/products?countryCode="+t.countryCode+"&isRecurring="+t.isRecurring+"&amount="+t.totalAmount+"&currencyCode="+t.currency+"&hide=fields"+a+"&cacheBust="+r).set("X-GCS-ClientMetaInfo",d.base64Encode(S)).set("Authorization","GCS v1Client:"+u.clientSessionId).end(function(e){if(e.success){var n=g(e.responseJSON,u.assetUrl,"s");k(n.paymentProducts,d.androidPayPaymentProductId)?y.isMerchantIdProvided(i)?y.isAndroidPayAvailable(t,i).then(function(t){d.filterOutProductsThatAreNotSupportedInThisBrowser(n),0===n.paymentProducts.length&&s.reject("No payment products available"),l[c]=n,s.resolve(n)},function(){d.filterOutProductsThatAreNotSupportedInThisBrowser(n),0===n.paymentProducts.length&&s.reject("No payment products available"),l[c]=n,s.resolve(n)}):(d.filterOutProductsThatAreNotSupportedInThisBrowser(n),console.warn("You have not provided a merchantId for Android Pay, you can set this in the paymentProductSpecificInputs object"),s.resolve(n)):(d.filterOutProductsThatAreNotSupportedInThisBrowser(n),0===n.paymentProducts.length&&s.reject("No payment products available"),l[c]=n,s.resolve(n))}else s.reject("failed to retrieve Basic Payment Products",e)})}return s},this.getBasicPaymentProductGroups=function(t){var i=t.locale?t.locale+"_":"",o=new e,s=(new Date).getTime(),r="getPaymentProductGroups-"+t.totalAmount+"_"+t.countryCode+"_"+i+t.isRecurring+"_"+t.currency;if(l[r])setTimeout(function(){o.resolve(l[r])},0);else{var c=t.locale?"&locale="+t.locale:"";n.get(m(u.clientApiUrl)+u.customerId+"/productgroups?countryCode="+t.countryCode+"&isRecurring="+t.isRecurring+"&amount="+t.totalAmount+"&currencyCode="+t.currency+"&hide=fields"+c+"&cacheBust="+s).set("X-GCS-ClientMetaInfo",d.base64Encode(S)).set("Authorization","GCS v1Client:"+u.clientSessionId).end(function(t){if(t.success){var e=g(t.responseJSON,u.assetUrl,"Groups");l[r]=e,o.resolve(e)}else o.reject()})}return o},this.getPaymentProduct=function(i,o,s){var s=s||{},r=o.locale?o.locale+"_":"",c=new e,a=(new Date).getTime(),h="getPaymentProduct-"+i+"_"+o.totalAmount+"_"+o.countryCode+"_"+r+o.isRecurring+"_"+o.currency+"_"+JSON.stringify(s);if(d.paymentProductsThatAreNotSupportedInThisBrowser.indexOf(i)>-1)setTimeout(function(){c.reject({errorId:"48b78d2d-1b35-4f8b-92cb-57cc2638e901",errors:[{code:"1007",propertyName:"productId",message:"UNKNOWN_PRODUCT_ID",httpStatusCode:404}]})},0);else if(p&&p.id===i)if(l[h])setTimeout(function(){c.resolve(l[h])},0);else{var f=v(p,u.assetUrl);l[h]=f,setTimeout(function(){c.resolve(l[h])},0)}else if(l[h])setTimeout(function(){c.resolve(l[h])},0);else{var P=o.locale?"&locale="+o.locale:"",g=m(u.clientApiUrl)+u.customerId+"/products/"+i+"?countryCode="+o.countryCode+"&isRecurring="+o.isRecurring+"&amount="+o.totalAmount+"&currencyCode="+o.currency+P;i===d.bancontactPaymentProductId&&s&&s.bancontact&&s.bancontact.forceBasicFlow&&(g+="&forceBasicFlow="+s.bancontact.forceBasicFlow),g+="&cacheBust="+a,n.get(g).set("X-GCS-ClientMetaInfo",d.base64Encode(S)).set("Authorization","GCS v1Client:"+u.clientSessionId).end(function(e){if(e.success){var n=v(e.responseJSON,t.assetUrl);i===d.androidPayPaymentProductId?y.isMerchantIdProvided(s)?y.isAndroidPayAvailable(o,s).then(function(t){t?(l[h]=n,c.resolve(n)):(l[h]=n,c.reject(n))},function(){l[h]=n,c.reject(n)}):(l[h]=n,c.reject(n)):(l[h]=n,c.resolve(n))}else c.reject("failed to retrieve Payment Product",e)})}return c},this.getPaymentProductGroup=function(i,o){var s=o.locale?o.locale+"_":"",r=new e,c=(new Date).getTime(),a="getPaymentProductGroup-"+i+"_"+o.totalAmount+"_"+o.countryCode+"_"+s+o.isRecurring+"_"+o.currency;if(p&&p.id===i)if(l[a])setTimeout(function(){r.resolve(l[a])},0);else{var h=v(p,u.assetUrl);l[a]=h,setTimeout(function(){r.resolve(l[a])},0)}else if(l[a])setTimeout(function(){r.resolve(l[a])},0);else{var y=o.locale?"&locale="+o.locale:"";n.get(m(u.clientApiUrl)+u.customerId+"/productgroups/"+i+"?countryCode="+o.countryCode+"&isRecurring="+o.isRecurring+"&amount="+o.totalAmount+"&currencyCode="+o.currency+y+"&cacheBust="+c).set("X-GCS-ClientMetaInfo",d.base64Encode(S)).set("Authorization","GCS v1Client:"+u.clientSessionId).end(function(e){if(e.success){var n=v(e.responseJSON,t.assetUrl);l[a]=n,r.resolve(n)}else r.reject()})}return r},this.getPaymentProductIdByCreditCardNumber=function(t,i){var o=new e,s=new r,c="getPaymentProductIdByCreditCardNumber-"+t,a=this;if(this.context=i,l[c])setTimeout(function(){o.resolve(l[c])},0);else{!function(t){return!(t.length<6)}(t)?(s.status="NOT_ENOUGH_DIGITS",setTimeout(function(){o.resolve(s)},0)):n.post(m(u.clientApiUrl)+u.customerId+"/services/getIINdetails").data(JSON.stringify(this.convertContextToIinDetailsContext(t,this.context))).set("X-GCS-ClientMetaInfo",d.base64Encode(S)).set("Authorization","GCS v1Client:"+u.clientSessionId).end(function(t){t.success?(s.json=t.responseJSON,s.countryCode=t.responseJSON.countryCode,s.paymentProductId=t.responseJSON.paymentProductId,s.isAllowedInContext=t.responseJSON.isAllowedInContext,s.coBrands=t.responseJSON.coBrands,t.responseJSON.hasOwnProperty("isAllowedInContext")?(s.status="SUPPORTED",!1===s.isAllowedInContext&&(s.status="EXISTING_BUT_NOT_ALLOWED"),l[c]=s,o.resolve(s)):a.getPaymentProduct(s.paymentProductId,a.context).then(function(t){s.status=t?"SUPPORTED":"UNSUPPORTED",l[c]=s,o.resolve(s)},function(){s.status="UNKNOWN",o.reject(s)})):(s.status="UNKNOWN",o.reject(s))})}return o},this.convertContextToIinDetailsContext=function(t,e){return{bin:t,paymentContext:{countryCode:e.countryCode,isRecurring:e.isRecurring,amountOfMoney:{amount:e.totalAmount,currencyCode:e.currency}}}},this.getPublicKey=function(){var t=new e;return l.publicKey?setTimeout(function(){t.resolve(l.publicKey)},0):n.get(m(u.clientApiUrl)+u.customerId+"/crypto/publickey").set("X-GCS-ClientMetaInfo",d.base64Encode(S)).set("Authorization","GCS v1Client:"+u.clientSessionId).end(function(e){if(e.success){var n=new o(e.responseJSON);l.publicKey=n,t.resolve(n)}else t.reject("unable to get public key")}),t},this.getPaymentProductPublicKey=function(t){var i=new e,o="paymentProductPublicKey";return l[o]?setTimeout(function(){i.resolve(l[o])},0):n.get(m(u.clientApiUrl)+u.customerId+"/products/"+t+"/publicKey").set("X-GCS-ClientMetaInfo",d.base64Encode(S)).set("Authorization","GCS v1Client:"+u.clientSessionId).end(function(t){if(t.success){var e=new s(t.responseJSON);l[o]=e,i.resolve(e)}else i.reject("unable to get payment product public key")}),i},this.getPaymentProductNetworks=function(t,i){var o=new e,s="paymentProductNetworks-"+t+"_"+i.countryCode+"_"+i.currency+"_"+i.totalAmount+"_"+i.isRecurring;return l[s]?setTimeout(function(){o.resolve(l[s])},0):n.get(m(u.clientApiUrl)+u.customerId+"/products/"+t+"/networks?countryCode="+i.countryCode+"&currencyCode="+i.currency+"&amount="+i.totalAmount+"&isRecurring="+i.isRecurring).set("X-GCS-ClientMetaInfo",d.base64Encode(S)).set("Authorization","GCS v1Client:"+u.clientSessionId).end(function(t){t.success?(l[s]=t.responseJSON,o.resolve(t.responseJSON)):o.reject()}),o},this.getPaymentProductDirectory=function(t,i,o){var s=new e,r="getPaymentProductDirectory-"+t+"_"+i+"_"+o;return l[r]?setTimeout(function(){s.resolve(l[r])},0):n.get(m(u.clientApiUrl)+u.customerId+"/products/"+t+"/directory?countryCode="+o+"&currencyCode="+i).set("X-GCS-ClientMetaInfo",d.base64Encode(S)).set("Authorization","GCS v1Client:"+u.clientSessionId).end(function(t){t.success?(l[r]=t.responseJSON,s.resolve(t.responseJSON)):s.reject("unable to retrieve payment product directory")}),s},this.convertAmount=function(t,i,o){var s=new e,r="convertAmount-"+t+"_"+i+"_"+o;return l[r]?setTimeout(function(){s.resolve(l[r])},0):n.get(m(u.clientApiUrl)+u.customerId+"/services/convert/amount?source="+i+"&target="+o+"&amount="+t).set("X-GCS-ClientMetaInfo",d.base64Encode(S)).set("Authorization","GCS v1Client:"+u.clientSessionId).end(function(t){t.success?(l[r]=t.responseJSON,s.resolve(t.responseJSON)):s.reject("unable to convert amount")}),s},this.getThirdPartyPaymentStatus=function(t){var i=new e;return n.get(m(u.clientApiUrl)+u.customerId+"/payments/"+t+"/thirdpartystatus").set("X-GCS-ClientMetaInfo",d.base64Encode(S)).set("Authorization","GCS v1Client:"+u.clientSessionId).end(function(t){t.success?i.resolve(t.responseJSON):i.reject("unable to retrieve third party status")}),i},this.getCustomerDetails=function(t,i){var o=new e,s="getCustomerDetails_"+i.countryCode;return s=I(s,i.values),l[s]?setTimeout(function(){o.resolve(l[s])},0):n.post(m(u.clientApiUrl)+u.customerId+"/products/"+t+"/customerDetails").data(JSON.stringify(i)).set("X-GCS-ClientMetaInfo",d.base64Encode(S)).set("Authorization","GCS v1Client:"+u.clientSessionId).end(function(t){t.success?(l[s]=t.responseJSON,o.resolve(t.responseJSON)):o.reject(t.responseJSON)}),o};var I=function(t,e){var n=t;for(var i in e)e.hasOwnProperty(i)&&(n+="_"+e[i].key+"_"+e[i].value);return n}};return t.C2SCommunicator=a,a}),define("connectsdk.LabelTemplateElement",["connectsdk.core"],function(t){var e=function(t){this.json=t,this.attributeKey=t.attributeKey,this.mask=t.mask,this.wildcardMask=t.mask?t.mask.replace(/9/g,"*"):""};return t.LabelTemplateElement=e,e}),define("connectsdk.Attribute",["connectsdk.core"],function(t){var e=function(t){this.json=t,this.key=t.key,this.value=t.value,this.status=t.status,this.mustWriteReason=t.mustWriteReason};return t.Attribute=e,e}),define("connectsdk.AccountOnFileDisplayHints",["connectsdk.core","connectsdk.LabelTemplateElement"],function(t,e){var n=function(t,n,i){if(t.labelTemplate)for(var o=0,s=t.labelTemplate.length;o<s;o++){var r=new e(t.labelTemplate[o]);n.push(r),i[r.attributeKey]=r}},i=function(t){this.json=t,this.labelTemplate=[],this.labelTemplateElementByAttributeKey={},n(t,this.labelTemplate,this.labelTemplateElementByAttributeKey)};return t.AccountOnFileDisplayHints=i,i}),define("connectsdk.AccountOnFile",["connectsdk.core","connectsdk.AccountOnFileDisplayHints","connectsdk.Attribute"],function(t,e,n){var i=function(t,e,i){if(t.attributes)for(var o=0,s=t.attributes.length;o<s;o++){var r=new n(t.attributes[o]);e.push(r),i[r.key]=r}},o=function(n){this.json=n,this.attributes=[],this.attributeByKey={},this.displayHints=new e(n.displayHints),this.id=n.id,this.paymentProductId=n.paymentProductId,this.getMaskedValueByAttributeKey=function(e){var n,i=this.attributeByKey[e].value;try{n=this.displayHints.labelTemplateElementByAttributeKey[e].wildcardMask}catch(t){}if(void 0!==i&&void 0!==n){return(new t.MaskingUtil).applyMask(n,i)}},i(n,this.attributes,this.attributeByKey)};return t.AccountOnFile=o,o}),define("connectsdk.PaymentProduct302SpecificData",["connectsdk.core"],function(t){var e=function(t){this.json=t,this.networks=t.networks};return t.PaymentProduct302SpecificData=e,e}),define("connectsdk.PaymentProduct320SpecificData",["connectsdk.core"],function(t){var e=function(t){this.json=t,this.networks=t.networks};return t.PaymentProduct320SpecificData=e,e}),define("connectsdk.PaymentProduct863SpecificData",["connectsdk.core"],function(t){var e=function(t){this.json=t,this.integrationTypes=t.integrationTypes};return t.PaymentProduct863SpecificData=e,e}),define("connectsdk.PaymentProductDisplayHints",["connectsdk.core"],function(t){var e=function(t){this.json=t,this.displayOrder=t.displayOrder,this.label=t.label,this.logo=t.logo};return t.PaymentProductDisplayHints=e,e}),define("connectsdk.BasicPaymentProduct",["connectsdk.core","connectsdk.AccountOnFile","connectsdk.PaymentProductDisplayHints","connectsdk.PaymentProduct302SpecificData","connectsdk.PaymentProduct320SpecificData","connectsdk.PaymentProduct863SpecificData"],function(t,e,n,i,o,s){var r=function(t,n,r,c){if(t.accountsOnFile)for(var a=0,u=t.accountsOnFile.length;a<u;a++){var d=new e(t.accountsOnFile[a]);r.push(d),c[d.id]=d}t.paymentProduct302SpecificData&&(n.paymentProduct302SpecificData=new i(t.paymentProduct302SpecificData)),t.paymentProduct320SpecificData&&(n.paymentProduct320SpecificData=new o(t.paymentProduct320SpecificData)),t.paymentProduct863SpecificData&&(n.paymentProduct863SpecificData=new s(t.paymentProduct863SpecificData))},c=function(t){this.json=t,this.json.type="product",this.accountsOnFile=[],this.accountOnFileById={},this.allowsRecurring=t.allowsRecurring,this.allowsTokenization=t.allowsTokenization,this.autoTokenized=t.autoTokenized,this.displayHints=new n(t.displayHints),this.id=t.id,this.maxAmount=t.maxAmount,this.minAmount=t.minAmount,this.paymentMethod=t.paymentMethod,this.mobileIntegrationLevel=t.mobileIntegrationLevel,this.usesRedirectionTo3rdParty=t.usesRedirectionTo3rdParty,this.paymentProductGroup=t.paymentProductGroup,r(t,this,this.accountsOnFile,this.accountOnFileById)};return t.BasicPaymentProduct=c,c}),define("connectsdk.BasicPaymentProductGroup",["connectsdk.core","connectsdk.AccountOnFile","connectsdk.PaymentProductDisplayHints"],function(t,e,n){var i=function(t,n,i){if(t.accountsOnFile)for(var o=0,s=t.accountsOnFile.length;o<s;o++){var r=new e(t.accountsOnFile[o]);n.push(r),i[r.id]=r}},o=function(t){this.json=t,this.json.type="group",this.id=t.id,this.displayHints=new n(t.displayHints),this.accountsOnFile=[],this.accountOnFileById={},i(t,this.accountsOnFile,this.accountOnFileById)};return t.BasicPaymentProductGroup=o,o}),define("connectsdk.MaskedString",["connectsdk.core"],function(t){var e=function(t,e){this.formattedValue=t,this.cursorIndex=e};return t.MaskedString=e,e}),define("connectsdk.MaskingUtil",["connectsdk.core","connectsdk.MaskedString"],function(t,e){var n=function(t,e,i,o,s){t+e<s.length&&t<o.length&&("9"===o[t]&&Number(s[t+e])>-1&&" "!==s[t+e]||"*"===o[t]?i.push(s[t+e]):s[t+e]===o[t]?i.push(s[t+e]):"9"!==o[t]&&"*"!==o[t]?(i.push(o[t]),e--):(s.splice(t+e,1),t--),n(t+1,e,i,o,s))},i=function(){this.applyMask=function(t,i,o){var s=[],r=i.split("");if(t){for(var c=t.split(""),a=[],u=0,d=c.length;u<d;u++){var l=c[u];"{"===l||"}"===l||a.push(l)}n(0,0,s,a,r)}else for(var u=0,d=r.length;u<d;u++){var l=r[u];s.push(l)}i=s.join("");var p=1;if(o)for(var h=o.split(""),u=0,d=s.length;u<d;u++)if(s[u]!==h[u]){p=u+1;break}return i.substring(0,i.length-1)===o&&(p=i.length+1),new e(i,p)},this.getMaxLengthBasedOnMask=function(t){if(t){for(var e=t.split(""),n=-1,i=0,o=e.length;i<o;i++){n++;var s=e[i];"{"!==s&&"}"!==s||n--}return n}},this.removeMask=function(t,e){var n=[],i=e?e.split(""):[];if(t)for(var o=t.split(""),s=-1,r=!1,c=0,a=o.length;c<a;c++){s++;var u=o[c];"{"===u||"}"===u?(s--,"{"===u?r=!0:"}"===u&&(r=!1)):r&&i[s]&&n.push(i[s])}else for(var c=0,a=i.length;c<a;c++){var u=i[c];n.push(u)}return n.join("").trim()}};return t.MaskingUtil=i,i}),define("connectsdk.ValidationRuleLuhn",["connectsdk.core"],function(t){var e=function(t){this.json=t,this.type=t.type,this.errorMessageId=t.type,this.validate=function(t){var e=[[0,2,4,6,8,1,3,5,7,9],[0,1,2,3,4,5,6,7,8,9]],n=0;return t.replace(/\D+/g,"").replace(/[\d]/g,function(t,i,o){n+=e[o.length-i&1][parseInt(t,10)]}),n%10==0&&n>0}};return t.ValidationRuleLuhn=e,e}),define("connectsdk.ValidationRuleExpirationDate",["connectsdk.core"],function(t){var e=function(t){return/\d{4}|\d{6}$/g.test(t)},n=function(t){this.json=t,this.type=t.type,this.errorMessageId=t.type,this.validate=function(t){if(t=t.replace(/[^\d]/g,""),4===t.length)split=[t.substring(0,2),"20"+t.substring(2,4)];else{if(6!==t.length)return!1;split=[t.substring(0,2),t.substring(2,6)]}if(e(t)){var n=new Date((new Date).getFullYear(),(new Date).getMonth(),1),i=new Date(split[1],split[0]-1,1);return i.getMonth()===Number(split[0]-1)&&i.getFullYear()===Number(split[1])&&i>=n}return!1}};return t.ValidationRuleExpirationDate=n,n}),define("connectsdk.ValidationRuleFixedList",["connectsdk.core"],function(t){var e=function(t){this.json=t,this.type=t.type,this.errorMessageId=t.type,this.allowedValues=t.attributes.allowedValues,this.validate=function(t){for(var e=0,n=this.allowedValues.length;e<n;e++)if(this.allowedValues[e]===t)return!0;return!1}};return t.ValidationRuleFixedList=e,e}),define("connectsdk.ValidationRuleLength",["connectsdk.core"],function(t){var e=function(t){this.json=t,this.type=t.type,this.errorMessageId=t.type,this.maxLength=t.attributes.maxLength,this.minLength=t.attributes.minLength,this.validate=function(t){return this.minLength<=t.length&&t.length<=this.maxLength}};return t.ValidationRuleLength=e,e}),define("connectsdk.ValidationRuleRange",["connectsdk.core"],function(t){var e=function(t){this.json=t,this.type=t.type,this.errorMessageId=t.type,this.maxValue=t.attributes.maxValue,this.minValue=t.attributes.minValue,this.validate=function(t){return!isNaN(t)&&(t=Number(t),this.minValue<=t&&t<=this.maxValue)}};return t.ValidationRuleRange=e,e}),define("connectsdk.ValidationRuleRegularExpression",["connectsdk.core"],function(t){var e=function(t){this.json=t,this.type=t.type,
this.errorMessageId=t.type,this.regularExpression=t.attributes.regularExpression,this.validate=function(t){return new RegExp(this.regularExpression).test(t)}};return t.ValidationRuleRegularExpression=e,e}),define("connectsdk.ValidationRuleEmailAddress",["connectsdk.core"],function(t){var e=function(t){this.json=t,this.type=t.type,this.errorMessageId=t.type,this.validate=function(t){return new RegExp(/^[^@\.]+(\.[^@\.]+)*@([^@\.]+\.)*[^@\.]+\.[^@\.][^@\.]+$/i).test(t)}};return t.ValidationRuleEmailAddress=e,e}),define("connectsdk.ValidationRuleTermsAndConditions",["connectsdk.core"],function(t){var e=function(t){this.json=t,this.type=t.type,this.errorMessageId=t.type,this.validate=function(t){return!0===t||"true"===t}};return t.ValidationRuleTermsAndConditions=e,e}),define("connectsdk.ValidationRuleBoletoBancarioRequiredness",["connectsdk.core"],function(t){var e=function(t){this.json=t,this.type=t.type,this.errorMessageId=t.type,this.fiscalNumberLength=t.attributes.fiscalNumberLength,this.validate=function(t,e){return e.length===this.fiscalNumberLength&&t.length>0||e.length!==this.fiscalNumberLength}};return t.ValidationRuleBoletoBancarioRequiredness=e,e}),define("connectsdk.ValidationRuleIban",["connectsdk.core"],function(t){var e=function(t){return t.replace(/[^\d\w]+/g,"").toUpperCase()},n=function(t){return"string"==typeof t&&/^[A-Z]{2}[0-9]{2}[A-Z0-9]{4}[0-9]{7}([A-Z0-9]?){0,16}$/.test(e(t))},i=function(t){return e(t).replace(/(^.{4})(.*)/,"$2$1").replace(/[A-Z]/g,function(t){return t.charCodeAt(0)-55})},o=function(t){this.json=t,this.type=t.type,this.errorMessageId=t.type,this.validate=function(t){if(!n(t))return!1;for(var e,o=i(t);o.length>2;)e=o.slice(0,9),o=parseInt(e,10)%97+o.slice(e.length);return parseInt(o,10)%97==1}};return t.ValidationRuleIban=o,o}),define("connectsdk.ValidationRuleFactory",["connectsdk.core","connectsdk.ValidationRuleEmailAddress","connectsdk.ValidationRuleTermsAndConditions","connectsdk.ValidationRuleExpirationDate","connectsdk.ValidationRuleFixedList","connectsdk.ValidationRuleLength","connectsdk.ValidationRuleLuhn","connectsdk.ValidationRuleRange","connectsdk.ValidationRuleRegularExpression","connectsdk.ValidationRuleBoletoBancarioRequiredness","connectsdk.ValidationRuleIban"],function(connectsdk,ValidationRuleEmailAddress,ValidationRuleTermsAndConditions,ValidationRuleExpirationDate,ValidationRuleFixedList,ValidationRuleLength,ValidationRuleLuhn,ValidationRuleRange,ValidationRuleRegularExpression,ValidationRuleBoletoBancarioRequiredness,ValidationRuleIban){var ValidationRuleFactory=function(){this.makeValidator=function(json){try{var classType=json.type.charAt(0).toUpperCase()+json.type.slice(1),className=eval("ValidationRule"+classType);return new className(json)}catch(t){console.warn("no validator for ",classType)}return null}};return connectsdk.ValidationRuleFactory=ValidationRuleFactory,ValidationRuleFactory}),define("connectsdk.DataRestrictions",["connectsdk.core","connectsdk.ValidationRuleExpirationDate","connectsdk.ValidationRuleFixedList","connectsdk.ValidationRuleLength","connectsdk.ValidationRuleLuhn","connectsdk.ValidationRuleRange","connectsdk.ValidationRuleRegularExpression","connectsdk.ValidationRuleEmailAddress","connectsdk.ValidationRuleTermsAndConditions","connectsdk.ValidationRuleIban","connectsdk.ValidationRuleFactory"],function(t,e,n,i,o,s,r,c,a,u,d){var l=function(t,e){this.json=t,this.isRequired=t.isRequired,this.validationRules=[],this.validationRuleByType={},function(t,e,n){var i=new d;if(t.validators)for(var o in t.validators){var s=i.makeValidator({type:o,attributes:t.validators[o]});s&&(e.push(s),n[s.type]=s)}}(t,this.validationRules,this.validationRuleByType)};return t.DataRestrictions=l,l}),define("connectsdk.ValueMappingElement",["connectsdk.core"],function(t){var e=function(t){this.json=t,this.displayName=t.displayName,this.value=t.value};return t.ValueMappingElement=e,e}),define("connectsdk.FormElement",["connectsdk.core","connectsdk.ValueMappingElement"],function(t,e){var n=function(t){this.json=t,this.type=t.type,this.valueMapping=[],function(t,n){if(t.valueMapping)for(var i=0,o=t.valueMapping.length;i<o;i++)n.push(new e(t.valueMapping[i]))}(t,this.valueMapping)};return t.FormElement=n,n}),define("connectsdk.Tooltip",["connectsdk.core"],function(t){var e=function(t){this.json=t,this.image=t.image,this.label=t.label};return t.Tooltip=e,e}),define("connectsdk.PaymentProductFieldDisplayHints",["connectsdk.core","connectsdk.Tooltip","connectsdk.FormElement"],function(t,e,n){var i=function(t){this.json=t,this.displayOrder=t.displayOrder,t.formElement&&(this.formElement=new n(t.formElement)),this.label=t.label,this.mask=t.mask,this.obfuscate=t.obfuscate,this.placeholderLabel=t.placeholderLabel,this.preferredInputType=t.preferredInputType,this.tooltip=t.tooltip?new e(t.tooltip):void 0,this.alwaysShow=t.alwaysShow,this.wildcardMask=t.mask?t.mask.replace(/9/g,"*"):""};return t.PaymentProductFieldDisplayHints=i,i}),define("connectsdk.PaymentProductField",["connectsdk.core","connectsdk.PaymentProductFieldDisplayHints","connectsdk.DataRestrictions","connectsdk.MaskingUtil"],function(t,e,n,i){var o=function(t){this.json=t,this.displayHints=new e(t.displayHints),this.dataRestrictions=new n(t.dataRestrictions,this.displayHints.mask),this.id=t.id,this.type=t.type;var o=[];this.getErrorCodes=function(t){return t&&(o=[],this.isValid(t)),o},this.isValid=function(t){var e=this.dataRestrictions.validationRules,n=!1;t=this.removeMask(t);for(var i=0,s=e.length;i<s;i++){var r=e[i];r.validate(t)||(n=!0,o.push(r.errorMessageId))}return!n},this.applyMask=function(t,e){return(new i).applyMask(this.displayHints.mask,t,e)},this.applyWildcardMask=function(t,e){return(new i).applyMask(this.displayHints.wildcardMask,t,e)},this.removeMask=function(t){return(new i).removeMask(this.displayHints.mask,t)}};return t.PaymentProductField=o,o}),define("connectsdk.PaymentProduct",["connectsdk.core","connectsdk.BasicPaymentProduct","connectsdk.PaymentProductField"],function(t,e,n){var i=function(t,e,i){if(t.fields)for(var o=0,s=t.fields.length;o<s;o++){var r=new n(t.fields[o]);e.push(r),i[r.id]=r}},o=function(t){var n=new e(t);return n.json=t,n.paymentProductFields=[],n.paymentProductFieldById={},i(n.json,n.paymentProductFields,n.paymentProductFieldById),n};return t.PaymentProduct=o,o}),define("connectsdk.PaymentProductGroup",["connectsdk.core","connectsdk.BasicPaymentProduct","connectsdk.PaymentProductField"],function(t,e,n){var i=function(t,e,i){if(t.fields)for(var o=0,s=t.fields.length;o<s;o++){var r=new n(t.fields[o]);e.push(r),i[r.id]=r}},o=function(t){var n=new e(t);return n.json=t,n.json.type="group",n.paymentProductFields=[],n.paymentProductFieldById={},i(n.json,n.paymentProductFields,n.paymentProductFieldById),n};return t.PaymentProductGroup=o,o}),define("connectsdk.BasicPaymentProducts",["connectsdk.core","connectsdk.BasicPaymentProduct"],function(t,e){var n=function(t,n,i,o,s,r){if(t.paymentProducts)for(var c=0,a=t.paymentProducts.length;c<a;c++){var u=new e(t.paymentProducts[c]);if(n.push(u),o[u.id]=u,u.accountsOnFile)for(var d=u.accountsOnFile,l=0,p=d.length;l<p;l++){var h=d[l];i.push(h),s[h.id]=h,r[h.id]=u}}},i=function(t){this.basicPaymentProducts=[],this.basicPaymentProductById={},this.basicPaymentProductByAccountOnFileId={},this.accountsOnFile=[],this.accountOnFileById={},this.json=t,n(t,this.basicPaymentProducts,this.accountsOnFile,this.basicPaymentProductById,this.accountOnFileById,this.basicPaymentProductByAccountOnFileId)};return t.BasicPaymentProducts=i,i}),define("connectsdk.BasicPaymentProductGroups",["connectsdk.core","connectsdk.BasicPaymentProductGroup"],function(t,e){var n=function(t,n,i,o,s){if(t.paymentProductGroups)for(var r=0,c=t.paymentProductGroups.length;r<c;r++){var a=new e(t.paymentProductGroups[r]);if(n.push(a),o[a.id]=a,a.accountsOnFile)for(var u=a.accountsOnFile,d=0,l=u.length;d<l;d++){var p=u[d];i.push(p),s[p.id]=p}}},i=function(t){this.basicPaymentProductGroups=[],this.basicPaymentProductGroupById={},this.accountsOnFile=[],this.accountOnFileById={},this.json=t,n(t,this.basicPaymentProductGroups,this.accountsOnFile,this.basicPaymentProductGroupById,this.accountOnFileById)};return t.BasicPaymentProductGroups=i,i}),define("connectsdk.BasicPaymentItems",["connectsdk.core"],function(t){"use strict";var e=function(t,e,n){var i=[];if(e){for(var o=0,s=e.basicPaymentProductGroups.length;o<s;o++)for(var r=e.basicPaymentProductGroups[o].id,c=!1,a=0,u=t.basicPaymentProducts.length;a<u;a++){var d=t.basicPaymentProducts[a].paymentProductGroup;d===r&&!1===c?(t.basicPaymentProducts.splice(a,1,e.basicPaymentProductGroups[o]),c=!0):d===r&&!0===c&&i.push(a)}for(var o=i.length-1,s=0;o>=s;o--)t.basicPaymentProducts.splice(i[o],1)}n.basicPaymentItems=JSON.parse(JSON.stringify(t.basicPaymentProducts));for(var o=0,s=n.basicPaymentItems.length;o<s;o++){var l=n.basicPaymentItems[o];if(n.basicPaymentItemById[l.id]=l,l.accountsOnFile)for(var p=l.accountsOnFile,a=0,u=p.length;a<u;a++){var h=p[a];n.accountsOnFile.push(h),n.accountOnFileById[h.id]=h}}},n=function(t,n){this.basicPaymentItems=[],this.basicPaymentItemById={},this.accountsOnFile=[],this.accountOnFileById={},e(t,n,this)};return t.BasicPaymentItems=n,n}),define("connectsdk.PaymentRequest",["connectsdk.core"],function(t){var e=function(t){var e={},n=null,i=null,o=!1;this.isValid=function(){var t=this.getErrorMessageIds(),e=this.getPaymentProduct();if(!e)return!1;for(var n=!0,i=0;i<e.paymentProductFields.length;i++){var o=e.paymentProductFields[i];if(o.dataRestrictions.isRequired){this.getValue(o.id)||this.getAccountOnFile()||(n=!1)}}return 0===t.length&&n},this.setValue=function(t,n){e[t]=n},this.setTokenize=function(t){o=t},this.getTokenize=function(){return o},this.getErrorMessageIds=function(){var t=[];for(key in e){var i=n.paymentProductFieldById[key];i&&(t=t.concat(i.getErrorCodes(e[key])))}return t},this.getValue=function(t){return e[t]},this.getValues=function(){return e},this.getMaskedValue=function(t){return n.paymentProductFieldById[t].applyMask(this.getValue(t)).formattedValue()},this.getMaskedValues=function(){var t=e,i=[];for(var o in t){var s=n.paymentProductFieldById[o],r=s.applyMask(this.getValue(o));i[o]=r.formattedValue}return i},this.getUnmaskedValues=function(){var t=e,i=[];for(var o in t){var s=n.paymentProductFieldById[o];if(s){var r=s.applyMask(this.getValue(o)),c=r.formattedValue;i[o]=s.removeMask(c)}}return i},this.setPaymentProduct=function(t){"group"!==t.type&&(n=t)},this.getPaymentProduct=function(){return n},this.setAccountOnFile=function(t){for(var n=0,o=t.attributes.length;n<o;n++){var s=t.attributes[n];delete e[s.key]}i=t},this.getAccountOnFile=function(){return i},this.getClientSessionID=function(){return t}};return t.PaymentRequest=e,e}),define("connectsdk.C2SPaymentProductContext",["connectsdk.core"],function(t){var e=function(t){this.totalAmount=void 0===t.totalAmount?"":t.totalAmount,this.countryCode=t.countryCode,this.isRecurring=void 0===t.isRecurring?"":t.isRecurring,this.currency=t.currency,void 0!==t.locale&&(this.locale=t.locale)};return t.C2SPaymentProductContext=e,e}),define("connectsdk.JOSEEncryptor",["connectsdk.core"],function(t){var e=forge.pki,n=(forge.asn1,function(t){return t=forge.util.encode64(t),t=t.split("=")[0],t=t.replace(/\+/g,"-"),t=t.replace(/\//g,"_")}),i=function(t){var e={alg:"RSA-OAEP",enc:"A256CBC-HS512",kid:t};return JSON.stringify(e)},o=function(t){var n=forge.util.decode64(t),i=forge.util.createBuffer(n,"raw"),o=forge.asn1.fromDer(i);return e.publicKeyFromAsn1(o)},s=function(t,e){return e.encrypt(t,"RSA-OAEP")},r=function(t,e,n){var i=forge.cipher.createCipher("AES-CBC",e);return i.start({iv:n}),i.update(forge.util.createBuffer(t)),i.finish(),i.output.bytes()},c=function(t){var e=forge.util.createBuffer(t),n=8*e.length(),i=forge.util.createBuffer();return i.putInt32(0),i.putInt32(n),i.bytes()},a=function(t,e,n,i,o){var s=forge.util.createBuffer();s.putBytes(e),s.putBytes(n),s.putBytes(i),s.putBytes(o);var r=s.bytes(),c=forge.hmac.create();return c.start(forge.sha512.create(),t),c.update(r),c.digest().bytes()},u=function(){this.encrypt=function(t,e){var u=JSON.stringify(t),d=i(e.keyId),l=n(d),p=forge.random.getBytesSync(64),h=o(e.publicKey),y=s(p,h),f=n(y),m=p.substring(0,32),P=p.substring(32),v=forge.random.getBytesSync(16),g=n(v),k=r(u,P,v),S=n(k),I=c(l),A=a(m,l,v,k,I),b=A.substring(0,A.length/2);return l+"."+f+"."+g+"."+S+"."+n(b)}};return t.JOSEEncryptor=u,u}),define("connectsdk.Encryptor",["connectsdk.core","connectsdk.promise","connectsdk.JOSEEncryptor"],function(t,e,n){var i=function(t){this.encrypt=function(i){var o=new e,s="";return t.then(function(t){if(i.isValid()){var e={clientSessionId:i.getClientSessionID(),nonce:forge.util.bytesToHex(forge.random.getBytesSync(16)),paymentProductId:i.getPaymentProduct().id,tokenize:i.getTokenize()};i.getAccountOnFile()&&(e.accountOnFileId=i.getAccountOnFile().id);for(var r=[],c=i.getUnmaskedValues(),a=Object.getOwnPropertyNames(c),u=0;u<a.length;u++){var d=a[u];"length"!==d&&r.push({key:d,value:c[d]})}e.paymentValues=r;var l=new n;s=l.encrypt(e,t),o.resolve(s)}else o.reject(i.getErrorMessageIds())},function(t){o.reject(t)}),o}};return t.Encryptor=i,i}),define("connectsdk.Session",["connectsdk.core","connectsdk.C2SCommunicator","connectsdk.C2SCommunicatorConfiguration","connectsdk.IinDetailsResponse","connectsdk.promise","connectsdk.C2SPaymentProductContext","connectsdk.BasicPaymentProducts","connectsdk.BasicPaymentProductGroups","connectsdk.PaymentProduct","connectsdk.PaymentProductGroup","connectsdk.BasicPaymentItems","connectsdk.PaymentRequest","connectsdk.Encryptor"],function(t,e,n,i,o,s,r,c,a,u,d,l,p){var h=function(t,i){var h,y,f,m,P,v,g=new n(t,"client/v1"),k=new e(g,i),S=this;this.clientApiUrl=g.clientApiUrl,this.assetUrl=g.assetUrl,this.getBasicPaymentProducts=function(t,e){var n=new o,i=new s(t);return k.getBasicPaymentProducts(i,e).then(function(e){f=t;var i=new r(e);n.resolve(i)},function(){n.reject()}),n},this.getBasicPaymentProductGroups=function(t){var e=new o,n=new s(t);return k.getBasicPaymentProductGroups(n).then(function(n){f=t;var i=new c(n);e.resolve(i)},function(){e.reject()}),e},this.getBasicPaymentItems=function(t,e,n){var i=new o;return e?S.getBasicPaymentProducts(t,n).then(function(e){S.getBasicPaymentProductGroups(t).then(function(t){var n=new d(e,t);i.resolve(n)},function(){i.reject()})},function(){i.reject()}):S.getBasicPaymentProducts(t,n).then(function(t){var e=new d(t,null);i.resolve(e)},function(){i.reject()}),i},this.getPaymentProduct=function(t,e,n){var i=new o;h=t;var r=new s(f||e);return k.getPaymentProduct(t,r,n).then(function(t){y=new a(t),i.resolve(y)},function(){y=null,i.reject()}),i},this.getPaymentProductGroup=function(t,e){var n=new o;P=t;var i=new s(f||e);return k.getPaymentProductGroup(t,i).then(function(t){v=new u(t),n.resolve(v)},function(){v=null,n.reject()}),n},this.getIinDetails=function(t,e){t=t.replace(/ /g,"").substring(0,6);var n=new s(f||e);return k.getPaymentProductIdByCreditCardNumber(t,n)},this.getPublicKey=function(){return k.getPublicKey()},this.getPaymentProductPublicKey=function(t){return k.getPaymentProductPublicKey(t)},this.getPaymentProductNetworks=function(t,e){var n=new o,i=new s(e);return k.getPaymentProductNetworks(t,i).then(function(t){f=e,n.resolve(t)},function(){n.reject()}),n},this.getPaymentProductDirectory=function(t,e,n){return k.getPaymentProductDirectory(t,e,n)},this.convertAmount=function(t,e,n){return k.convertAmount(t,e,n)},this.getPaymentRequest=function(){return m||(m=new l(g.clientSessionId)),m},this.getEncryptor=function(){var t=k.getPublicKey();return new p(t)},this.getThirdPartyPaymentStatus=function(t){var e=new o;return k.getThirdPartyPaymentStatus(t).then(function(t){e.resolve(t)},function(){e.reject()}),e},this.getCustomerDetails=function(t,e){return k.getCustomerDetails(t,e)}};return t.Session=h,h});
//# sourceMappingURL=connectsdk.noEncrypt.min.js.map
